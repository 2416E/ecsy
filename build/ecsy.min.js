!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):(e=e||self,function(){var n=e.ECSY,s=e.ECSY={};t(s),s.noConflict=function(){return e.ECSY=n,s}}())}(this,(function(e){"use strict";class t{constructor(e){this._systems=[],this._executeSystems=[],this.world=e}registerSystem(e,t){var n=new e(this.world,t);return n.init&&n.init(),n.order=this._systems.length,this._systems.push(n),n.execute&&this._executeSystems.push(n),this.sortSystems(),this}sortSystems(){this._executeSystems.sort((e,t)=>e.priority-t.priority||e.order-t.order)}getSystem(e){return this._systems.find(t=>t instanceof e)}getSystems(){return this._systems}removeSystem(e){var t=this._systems.indexOf(e);~t&&this._systems.splice(t,1)}execute(e,t){this._executeSystems.forEach(n=>{if(n.enabled&&n.initialized){if(n.canExecute()){let s=performance.now();n.execute(e,t),n.executeTime=performance.now()-s}n.clearEvents()}})}stats(){for(var e={numSystems:this._systems.length,systems:{}},t=0;t<this._systems.length;t++){var n=this._systems[t],s=e.systems[n.constructor.name]={queries:{}};for(var o in n.ctx)s.queries[o]=n.ctx[o].stats()}return e}}class n{constructor(){this._listeners={},this.stats={fired:0,handled:0}}addEventListener(e,t){let n=this._listeners;void 0===n[e]&&(n[e]=[]),-1===n[e].indexOf(t)&&n[e].push(t)}hasEventListener(e,t){return void 0!==this._listeners[e]&&-1!==this._listeners[e].indexOf(t)}removeEventListener(e,t){var n=this._listeners[e];if(void 0!==n){var s=n.indexOf(t);-1!==s&&n.splice(s,1)}}dispatchEvent(e,t,n){this.stats.fired++;var s=this._listeners[e];if(void 0!==s)for(var o=s.slice(0),i=0;i<o.length;i++)o[i].call(this,t,n)}resetCounters(){this.stats.fired=this.stats.handled=0}}function s(e){return e.name}function o(e){var t=s(e);return t.charAt(0).toLowerCase()+t.slice(1)}function i(e){for(var t=[],n=0;n<e.length;n++){var o=e[n];if("object"==typeof o){var i="not"===o.operator?"!":o.operator;t.push(i+s(o.Component))}else t.push(s(o))}return t.map((function(e){return e.toLowerCase()})).sort().join("-")}class r{constructor(e,t){if(this.Components=[],this.NotComponents=[],e.forEach(e=>{"object"==typeof e?this.NotComponents.push(e.Component):this.Components.push(e)}),0===this.Components.length)throw new Error("Can't create a query without components");this.entities=[],this.eventDispatcher=new n,this.reactive=!1,this.key=i(e);for(var s=0;s<t._entities.length;s++){var o=t._entities[s];this.match(o)&&(o.queries.push(this),this.entities.push(o))}}addEntity(e){e.queries.push(this),this.entities.push(e),this.eventDispatcher.dispatchEvent(r.prototype.ENTITY_ADDED,e)}removeEntity(e){let t=this.entities.indexOf(e);~t&&(this.entities.splice(t,1),t=e.queries.indexOf(this),e.queries.splice(t,1),this.eventDispatcher.dispatchEvent(r.prototype.ENTITY_REMOVED,e))}match(e){return e.hasAllComponents(this.Components)&&!e.hasAnyComponents(this.NotComponents)}stats(){return{numComponents:this.Components.length,numEntities:this.entities.length}}}r.prototype.ENTITY_ADDED="Query#ENTITY_ADDED",r.prototype.ENTITY_REMOVED="Query#ENTITY_REMOVED",r.prototype.COMPONENT_CHANGED="Query#COMPONENT_CHANGED";var a=0;class h{constructor(e){this._world=e||null,this.id=a++,this._ComponentTypes=[],this._components={},this._componentsToRemove={},this.queries=[],this._ComponentTypesToRemove=[],this.alive=!1}getComponent(e){return this._components[e.name]}getRemovedComponent(e){return this._componentsToRemove[e.name]}getComponents(){return this._components}getComponentsToRemove(){return this._componentsToRemove}getComponentTypes(){return this._ComponentTypes}getMutableComponent(e){for(var t=this._components[e.name],n=0;n<this.queries.length;n++){var s=this.queries[n];s.reactive&&-1!==s.Components.indexOf(e)&&s.eventDispatcher.dispatchEvent(r.prototype.COMPONENT_CHANGED,this,t)}return t}addComponent(e,t){return this._world.entityAddComponent(this,e,t),this}removeComponent(e,t){return this._world.entityRemoveComponent(this,e,t),this}hasComponent(e){return!!~this._ComponentTypes.indexOf(e)}hasRemovedComponent(e){return!!~this._ComponentTypesToRemove.indexOf(e)}hasAllComponents(e){for(var t=0;t<e.length;t++)if(!this.hasComponent(e[t]))return!1;return!0}hasAnyComponents(e){for(var t=0;t<e.length;t++)if(this.hasComponent(e[t]))return!0;return!1}removeAllComponents(e){return this._world.entityRemoveAllComponents(this,e)}reset(){this.id=a++,this._world=null,this._ComponentTypes.length=0,this.queries.length=0,this._components={}}remove(e){return this._world.removeEntity(this,e)}}class p{constructor(e,t){this.freeList=[],this.count=0,this.T=e;var n=null;arguments.length>1&&(n=Array.prototype.slice.call(arguments)).shift(),this.createElement=n?()=>new e(...n):()=>new e,void 0!==t&&this.expand(t)}aquire(){return this.freeList.length<=0&&this.expand(Math.round(.2*this.count)+1),this.freeList.pop()}release(e){e.reset(),this.freeList.push(e)}expand(e){for(var t=0;t<e;t++)this.freeList.push(this.createElement());this.count+=e}totalSize(){return this.count}totalFree(){return this.freeList.length}totalUsed(){return this.count-this.freeList.length}}class m{constructor(e){this._world=e,this._queries={}}onEntityRemoved(e){for(var t in this._queries){var n=this._queries[t];-1!==e.queries.indexOf(n)&&n.removeEntity(e)}}onEntityComponentAdded(e,t){for(var n in this._queries){var s=this._queries[n];~s.NotComponents.indexOf(t)&&~s.entities.indexOf(e)?s.removeEntity(e):~s.Components.indexOf(t)&&s.match(e)&&!~s.entities.indexOf(e)&&s.addEntity(e)}}onEntityComponentRemoved(e,t){for(var n in this._queries){var s=this._queries[n];~s.NotComponents.indexOf(t)&&!~s.entities.indexOf(e)&&s.match(e)?s.addEntity(e):~s.Components.indexOf(t)&&~s.entities.indexOf(e)&&!s.match(e)&&s.removeEntity(e)}}getQuery(e){var t=i(e),n=this._queries[t];return n||(this._queries[t]=n=new r(e,this._world)),n}stats(){var e={};for(var t in this._queries)e[t]=this._queries[t].stats();return e}}class l{}class c{constructor(e){this.world=e,this.componentsManager=e.componentsManager,this._entities=[],this._queryManager=new m(this),this.eventDispatcher=new n,this._entityPool=new p(h),this.entitiesWithComponentsToRemove=[],this.entitiesToRemove=[],this.numStateComponents=0}createEntity(){var e=this._entityPool.aquire();return e.alive=!0,e._world=this,this._entities.push(e),this.eventDispatcher.dispatchEvent(u,e),e}entityAddComponent(e,t,n){if(!~e._ComponentTypes.indexOf(t)){e._ComponentTypes.push(t),t.__proto__===l&&this.numStateComponents++;var s=this.world.componentsManager.getComponentsPool(t).aquire();if(e._components[t.name]=s,n)if(s.copy)s.copy(n);else for(var o in n)s[o]=n[o];this._queryManager.onEntityComponentAdded(e,t),this.world.componentsManager.componentAddedToEntity(t),this.eventDispatcher.dispatchEvent(d,e,t)}}entityRemoveComponent(e,t,n){var o=e._ComponentTypes.indexOf(t);if(~o){if(this.eventDispatcher.dispatchEvent(v,e,t),n)this._entityRemoveComponentSync(e,t,o);else{0===e._ComponentTypesToRemove.length&&this.entitiesWithComponentsToRemove.push(e),e._ComponentTypes.splice(o,1),e._ComponentTypesToRemove.push(t);var i=s(t);e._componentsToRemove[i]=e._components[i],delete e._components[i]}this._queryManager.onEntityComponentRemoved(e,t),t.__proto__===l&&(this.numStateComponents--,0!==this.numStateComponents||e.alive||e.remove())}}_entityRemoveComponentSync(e,t,n){e._ComponentTypes.splice(n,1);var i=o(t),r=s(t),a=e._components[r];delete e._components[r],this.componentsManager._componentPool[i].release(a),this.world.componentsManager.componentRemovedFromEntity(t)}entityRemoveAllComponents(e,t){let n=e._ComponentTypes;for(let s=n.length-1;s>=0;s--)n[s].__proto__!==l&&this.entityRemoveComponent(e,n[s],t)}removeEntity(e,t){var n=this._entities.indexOf(e);if(!~n)throw new Error("Tried to remove entity not in list");e.alive=!1,0===this.numStateComponents&&(this.eventDispatcher.dispatchEvent(y,e),this._queryManager.onEntityRemoved(e),!0===t?this._releaseEntity(e,n):this.entitiesToRemove.push(e)),this.entityRemoveAllComponents(e,t)}_releaseEntity(e,t){this._entities.splice(t,1),e._world=null,this._entityPool.release(e)}removeAllEntities(){for(var e=this._entities.length-1;e>=0;e--)this.removeEntity(this._entities[e])}processDeferredRemoval(){for(let e=0;e<this.entitiesToRemove.length;e++){let t=this.entitiesToRemove[e],n=this._entities.indexOf(t);this._releaseEntity(t,n)}this.entitiesToRemove.length=0;for(let i=0;i<this.entitiesWithComponentsToRemove.length;i++){let r=this.entitiesWithComponentsToRemove[i];for(;r._ComponentTypesToRemove.length>0;){let i=r._ComponentTypesToRemove.pop();var e=o(i),t=s(i),n=r._componentsToRemove[t];delete r._componentsToRemove[t],this.componentsManager._componentPool[e].release(n)}}this.entitiesWithComponentsToRemove.length=0}queryComponents(e){return this._queryManager.getQuery(e)}count(){return this._entities.length}stats(){var e={numEntities:this._entities.length,numQueries:Object.keys(this._queryManager._queries).length,queries:this._queryManager.stats(),numComponentPool:Object.keys(this.componentsManager._componentPool).length,componentPool:{},eventDispatcher:this.eventDispatcher.stats};for(var t in this.componentsManager._componentPool){var n=this.componentsManager._componentPool[t];e.componentPool[t]={used:n.totalUsed(),size:n.count}}return e}}const u="EntityManager#ENTITY_CREATE",y="EntityManager#ENTITY_REMOVED",d="EntityManager#COMPONENT_ADDED",v="EntityManager#COMPONENT_REMOVE";class f{constructor(e){this.count=0,this.used=0,this.T=e}aquire(){return this.used++,this.count++,new this.T}release(){this.used--}totalSize(){return this.count}totalFree(){return 1/0}totalUsed(){return this.used}}class _{constructor(){this.Components={},this._componentPool={},this.numComponents={}}registerComponent(e){this.Components[e.name]=e,this.numComponents[e.name]=0}componentAddedToEntity(e){this.numComponents[e.name]?this.numComponents[e.name]++:this.numComponents[e.name]=1}componentRemovedFromEntity(e){this.numComponents[e.name]--}getComponentsPool(e){var t=o(e);return this._componentPool[t]||(e.prototype.reset?this._componentPool[t]=new p(e):(console.warn(`Component '${e.name}' won't benefit from pooling because 'reset' method was not implemeneted.`),this._componentPool[t]=new f(e))),this._componentPool[t]}}function C(e){var t=["create","reset","clear"].filter(t=>!e[t]);if(t.length>0)throw new Error(`createType expect type definition to implements the following functions: ${t.join(", ")}`);return e.isType=!0,e}var g={};g.Number=C({baseType:Number,isSimpleType:!0,create:e=>void 0!==e?e:0,reset:(e,t,n)=>{e[t]=void 0!==n?n:0},clear:(e,t)=>{e[t]=0}}),g.Boolean=C({baseType:Boolean,isSimpleType:!0,create:e=>void 0!==e&&e,reset:(e,t,n)=>{e[t]=void 0!==n&&n},clear:(e,t)=>{e[t]=!1}}),g.String=C({baseType:String,isSimpleType:!0,create:e=>void 0!==e?e:"",reset:(e,t,n)=>{e[t]=void 0!==n?n:""},clear:(e,t)=>{e[t]=""}}),g.Array=C({baseType:Array,create:e=>void 0!==e?e.slice():[],reset:(e,t,n)=>{void 0!==n?e[t]=n.slice():e[t].length=0},clear:(e,t)=>{e[t].length=0},copy:(e,t,n)=>{e[n]=t[n].slice()}});var E={number:g.Number,boolean:g.Boolean,string:g.String};function T(e){return Array.isArray(e)?g.Array:E[typeof e]?E[typeof e]:null}e.Component=class{},e.Not=function(e){return{operator:"not",Component:e}},e.System=class{canExecute(){if(0===this._mandatoryQueries.length)return!0;for(let e=0;e<this._mandatoryQueries.length;e++){if(0===this._mandatoryQueries[e].entities.length)return!1}return!0}constructor(e,t){if(this.world=e,this.enabled=!0,this._queries={},this.queries={},this.priority=0,this.executeTime=0,t&&t.priority&&(this.priority=t.priority),this._mandatoryQueries=[],this.initialized=!0,this.constructor.queries)for(var n in this.constructor.queries){var s=this.constructor.queries[n],o=s.components;if(!o||0===o.length)throw new Error("'components' attribute can't be empty in a query");var i=this.world.entityManager.queryComponents(o);this._queries[n]=i,!0===s.mandatory&&this._mandatoryQueries.push(i),this.queries[n]={results:i.entities};const e={added:r.prototype.ENTITY_ADDED,removed:r.prototype.ENTITY_REMOVED,changed:r.prototype.COMPONENT_CHANGED};s.listen&&["added","removed","changed"].forEach(t=>{if(s.listen[t]){let o=s.listen[t];if("changed"===t){if(i.reactive=!0,!0===o){let e=this.queries[n][t]=[];i.eventDispatcher.addEventListener(r.prototype.COMPONENT_CHANGED,t=>{-1===e.indexOf(t)&&e.push(t)})}else if(Array.isArray(o)){let e=this.queries[n][t]=[];i.eventDispatcher.addEventListener(r.prototype.COMPONENT_CHANGED,(t,n)=>{-1!==o.indexOf(n.constructor)&&-1===e.indexOf(t)&&e.push(t)})}}else{let s=this.queries[n][t]=[];i.eventDispatcher.addEventListener(e[t],e=>{-1===s.indexOf(e)&&s.push(e)})}}})}}stop(){this.enabled=!1}play(){this.enabled=!0}clearEvents(){for(let t in this.queries){var e=this.queries[t];if(e.added&&(e.added.length=0),e.removed&&(e.removed.length=0),e.changed)if(Array.isArray(e.changed))e.changed.length=0;else for(let t in e.changed)e.changed[t].length=0}}toJSON(){return{name:this.constructor.name,enabled:this.enabled,executeTime:this.executeTime,priority:this.priority,queries:{}}}},e.SystemStateComponent=l,e.TagComponent=class{reset(){}},e.Types=g,e.World=class{constructor(){if(this.componentsManager=new _(this),this.entityManager=new c(this),this.systemManager=new t(this),this.enabled=!0,this.eventQueues={},"undefined"!=typeof CustomEvent){var e=new CustomEvent("ecsy-world-created",{detail:this});window.dispatchEvent(e)}}registerComponent(e){return this.componentsManager.registerComponent(e),this}registerSystem(e,t){return this.systemManager.registerSystem(e,t),this}getSystem(e){return this.systemManager.getSystem(e)}getSystems(){return this.systemManager.getSystems()}execute(e,t){this.enabled&&(this.systemManager.execute(e,t),this.entityManager.processDeferredRemoval())}stop(){this.enabled=!1}play(){this.enabled=!0}createEntity(){return this.entityManager.createEntity()}stats(){var e={entities:this.entityManager.stats(),system:this.systemManager.stats()};console.log(JSON.stringify(e,null,2))}},e.createComponentClass=function(e,t){for(let t in e){e[t].type||(e[t].type=T(e[t].default))}var n=function(){for(let n in e){var t=e[n];let s=t.type;s&&s.isType?this[n]=s.create(t.default):this[n]=t.default}};void 0!==t&&Object.defineProperty(n,"name",{value:t}),n.prototype.schema=e;var s=!0;for(let t in e){var o=e[t];o.type||(o.type=T(o.default)),o.type||(console.warn(`Unknown type definition for attribute '${t}'`),s=!1)}if(s){n.prototype.copy=function(t){for(let n in e)if(t[n]){let s=e[n].type;s.isSimpleType?this[n]=t[n]:s.copy?s.copy(this,t,n):console.warn(`Unknown copy function for attribute '${n}' data type`)}},n.prototype.reset=function(){for(let t in e){let n=e[t],s=n.type;s.reset&&s.reset(this,t,n.default)}},n.prototype.clear=function(){for(let t in e){let n=e[t].type;n.clear&&n.clear(this,t)}};for(let t in e){let s=e[t],o=s.type;n.prototype[t]=s.default,o.reset&&o.reset(n.prototype,t,s.default)}}else for(var i in console.warn("This component can't use pooling because some data types are not registered. Please provide a type created with 'createType'"),e){let t=e[i];n.prototype[i]=t.default}return n},e.createType=C,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZWNzeS5taW4uanMiLCJzb3VyY2VzIjpbIi4uL3NyYy9TeXN0ZW1NYW5hZ2VyLmpzIiwiLi4vc3JjL0V2ZW50RGlzcGF0Y2hlci5qcyIsIi4uL3NyYy9VdGlscy5qcyIsIi4uL3NyYy9RdWVyeS5qcyIsIi4uL3NyYy9FbnRpdHkuanMiLCIuLi9zcmMvT2JqZWN0UG9vbC5qcyIsIi4uL3NyYy9RdWVyeU1hbmFnZXIuanMiLCIuLi9zcmMvU3lzdGVtU3RhdGVDb21wb25lbnQuanMiLCIuLi9zcmMvRW50aXR5TWFuYWdlci5qcyIsIi4uL3NyYy9EdW1teU9iamVjdFBvb2wuanMiLCIuLi9zcmMvQ29tcG9uZW50TWFuYWdlci5qcyIsIi4uL3NyYy9DcmVhdGVUeXBlLmpzIiwiLi4vc3JjL1N0YW5kYXJkVHlwZXMuanMiLCIuLi9zcmMvSW5mZXJUeXBlLmpzIiwiLi4vc3JjL0NvbXBvbmVudC5qcyIsIi4uL3NyYy9TeXN0ZW0uanMiLCIuLi9zcmMvVGFnQ29tcG9uZW50LmpzIiwiLi4vc3JjL1dvcmxkLmpzIiwiLi4vc3JjL0NyZWF0ZUNvbXBvbmVudENsYXNzLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBjbGFzcyBTeXN0ZW1NYW5hZ2VyIHtcbiAgY29uc3RydWN0b3Iod29ybGQpIHtcbiAgICB0aGlzLl9zeXN0ZW1zID0gW107XG4gICAgdGhpcy5fZXhlY3V0ZVN5c3RlbXMgPSBbXTsgLy8gU3lzdGVtcyB0aGF0IGhhdmUgYGV4ZWN1dGVgIG1ldGhvZFxuICAgIHRoaXMud29ybGQgPSB3b3JsZDtcbiAgfVxuXG4gIHJlZ2lzdGVyU3lzdGVtKFN5c3RlbSwgYXR0cmlidXRlcykge1xuICAgIHZhciBzeXN0ZW0gPSBuZXcgU3lzdGVtKHRoaXMud29ybGQsIGF0dHJpYnV0ZXMpO1xuICAgIGlmIChzeXN0ZW0uaW5pdCkgc3lzdGVtLmluaXQoKTtcbiAgICBzeXN0ZW0ub3JkZXIgPSB0aGlzLl9zeXN0ZW1zLmxlbmd0aDtcbiAgICB0aGlzLl9zeXN0ZW1zLnB1c2goc3lzdGVtKTtcbiAgICBpZiAoc3lzdGVtLmV4ZWN1dGUpIHRoaXMuX2V4ZWN1dGVTeXN0ZW1zLnB1c2goc3lzdGVtKTtcbiAgICB0aGlzLnNvcnRTeXN0ZW1zKCk7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICBzb3J0U3lzdGVtcygpIHtcbiAgICB0aGlzLl9leGVjdXRlU3lzdGVtcy5zb3J0KChhLCBiKSA9PiB7XG4gICAgICByZXR1cm4gYS5wcmlvcml0eSAtIGIucHJpb3JpdHkgfHwgYS5vcmRlciAtIGIub3JkZXI7XG4gICAgfSk7XG4gIH1cblxuICBnZXRTeXN0ZW0oU3lzdGVtKSB7XG4gICAgcmV0dXJuIHRoaXMuX3N5c3RlbXMuZmluZChzID0+IHMgaW5zdGFuY2VvZiBTeXN0ZW0pO1xuICB9XG5cbiAgZ2V0U3lzdGVtcygpIHtcbiAgICByZXR1cm4gdGhpcy5fc3lzdGVtcztcbiAgfVxuXG4gIHJlbW92ZVN5c3RlbShTeXN0ZW0pIHtcbiAgICB2YXIgaW5kZXggPSB0aGlzLl9zeXN0ZW1zLmluZGV4T2YoU3lzdGVtKTtcbiAgICBpZiAoIX5pbmRleCkgcmV0dXJuO1xuXG4gICAgdGhpcy5fc3lzdGVtcy5zcGxpY2UoaW5kZXgsIDEpO1xuICB9XG5cbiAgZXhlY3V0ZShkZWx0YSwgdGltZSkge1xuICAgIHRoaXMuX2V4ZWN1dGVTeXN0ZW1zLmZvckVhY2goc3lzdGVtID0+IHtcbiAgICAgIGlmIChzeXN0ZW0uZW5hYmxlZCAmJiBzeXN0ZW0uaW5pdGlhbGl6ZWQpIHtcbiAgICAgICAgaWYgKHN5c3RlbS5jYW5FeGVjdXRlKCkpIHtcbiAgICAgICAgICBsZXQgc3RhcnRUaW1lID0gcGVyZm9ybWFuY2Uubm93KCk7XG4gICAgICAgICAgc3lzdGVtLmV4ZWN1dGUoZGVsdGEsIHRpbWUpO1xuICAgICAgICAgIHN5c3RlbS5leGVjdXRlVGltZSA9IHBlcmZvcm1hbmNlLm5vdygpIC0gc3RhcnRUaW1lO1xuICAgICAgICB9XG4gICAgICAgIHN5c3RlbS5jbGVhckV2ZW50cygpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgc3RhdHMoKSB7XG4gICAgdmFyIHN0YXRzID0ge1xuICAgICAgbnVtU3lzdGVtczogdGhpcy5fc3lzdGVtcy5sZW5ndGgsXG4gICAgICBzeXN0ZW1zOiB7fVxuICAgIH07XG5cbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuX3N5c3RlbXMubGVuZ3RoOyBpKyspIHtcbiAgICAgIHZhciBzeXN0ZW0gPSB0aGlzLl9zeXN0ZW1zW2ldO1xuICAgICAgdmFyIHN5c3RlbVN0YXRzID0gKHN0YXRzLnN5c3RlbXNbc3lzdGVtLmNvbnN0cnVjdG9yLm5hbWVdID0ge1xuICAgICAgICBxdWVyaWVzOiB7fVxuICAgICAgfSk7XG4gICAgICBmb3IgKHZhciBuYW1lIGluIHN5c3RlbS5jdHgpIHtcbiAgICAgICAgc3lzdGVtU3RhdHMucXVlcmllc1tuYW1lXSA9IHN5c3RlbS5jdHhbbmFtZV0uc3RhdHMoKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gc3RhdHM7XG4gIH1cbn1cbiIsIi8qKlxuICogQHByaXZhdGVcbiAqIEBjbGFzcyBFdmVudERpc3BhdGNoZXJcbiAqL1xuZXhwb3J0IGRlZmF1bHQgY2xhc3MgRXZlbnREaXNwYXRjaGVyIHtcbiAgY29uc3RydWN0b3IoKSB7XG4gICAgdGhpcy5fbGlzdGVuZXJzID0ge307XG4gICAgdGhpcy5zdGF0cyA9IHtcbiAgICAgIGZpcmVkOiAwLFxuICAgICAgaGFuZGxlZDogMFxuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogQWRkIGFuIGV2ZW50IGxpc3RlbmVyXG4gICAqIEBwYXJhbSB7U3RyaW5nfSBldmVudE5hbWUgTmFtZSBvZiB0aGUgZXZlbnQgdG8gbGlzdGVuXG4gICAqIEBwYXJhbSB7RnVuY3Rpb259IGxpc3RlbmVyIENhbGxiYWNrIHRvIHRyaWdnZXIgd2hlbiB0aGUgZXZlbnQgaXMgZmlyZWRcbiAgICovXG4gIGFkZEV2ZW50TGlzdGVuZXIoZXZlbnROYW1lLCBsaXN0ZW5lcikge1xuICAgIGxldCBsaXN0ZW5lcnMgPSB0aGlzLl9saXN0ZW5lcnM7XG4gICAgaWYgKGxpc3RlbmVyc1tldmVudE5hbWVdID09PSB1bmRlZmluZWQpIHtcbiAgICAgIGxpc3RlbmVyc1tldmVudE5hbWVdID0gW107XG4gICAgfVxuXG4gICAgaWYgKGxpc3RlbmVyc1tldmVudE5hbWVdLmluZGV4T2YobGlzdGVuZXIpID09PSAtMSkge1xuICAgICAgbGlzdGVuZXJzW2V2ZW50TmFtZV0ucHVzaChsaXN0ZW5lcik7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIENoZWNrIGlmIGFuIGV2ZW50IGxpc3RlbmVyIGlzIGFscmVhZHkgYWRkZWQgdG8gdGhlIGxpc3Qgb2YgbGlzdGVuZXJzXG4gICAqIEBwYXJhbSB7U3RyaW5nfSBldmVudE5hbWUgTmFtZSBvZiB0aGUgZXZlbnQgdG8gY2hlY2tcbiAgICogQHBhcmFtIHtGdW5jdGlvbn0gbGlzdGVuZXIgQ2FsbGJhY2sgZm9yIHRoZSBzcGVjaWZpZWQgZXZlbnRcbiAgICovXG4gIGhhc0V2ZW50TGlzdGVuZXIoZXZlbnROYW1lLCBsaXN0ZW5lcikge1xuICAgIHJldHVybiAoXG4gICAgICB0aGlzLl9saXN0ZW5lcnNbZXZlbnROYW1lXSAhPT0gdW5kZWZpbmVkICYmXG4gICAgICB0aGlzLl9saXN0ZW5lcnNbZXZlbnROYW1lXS5pbmRleE9mKGxpc3RlbmVyKSAhPT0gLTFcbiAgICApO1xuICB9XG5cbiAgLyoqXG4gICAqIFJlbW92ZSBhbiBldmVudCBsaXN0ZW5lclxuICAgKiBAcGFyYW0ge1N0cmluZ30gZXZlbnROYW1lIE5hbWUgb2YgdGhlIGV2ZW50IHRvIHJlbW92ZVxuICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBsaXN0ZW5lciBDYWxsYmFjayBmb3IgdGhlIHNwZWNpZmllZCBldmVudFxuICAgKi9cbiAgcmVtb3ZlRXZlbnRMaXN0ZW5lcihldmVudE5hbWUsIGxpc3RlbmVyKSB7XG4gICAgdmFyIGxpc3RlbmVyQXJyYXkgPSB0aGlzLl9saXN0ZW5lcnNbZXZlbnROYW1lXTtcbiAgICBpZiAobGlzdGVuZXJBcnJheSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICB2YXIgaW5kZXggPSBsaXN0ZW5lckFycmF5LmluZGV4T2YobGlzdGVuZXIpO1xuICAgICAgaWYgKGluZGV4ICE9PSAtMSkge1xuICAgICAgICBsaXN0ZW5lckFycmF5LnNwbGljZShpbmRleCwgMSk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIERpc3BhdGNoIGFuIGV2ZW50XG4gICAqIEBwYXJhbSB7U3RyaW5nfSBldmVudE5hbWUgTmFtZSBvZiB0aGUgZXZlbnQgdG8gZGlzcGF0Y2hcbiAgICogQHBhcmFtIHtFbnRpdHl9IGVudGl0eSAoT3B0aW9uYWwpIEVudGl0eSB0byBlbWl0XG4gICAqIEBwYXJhbSB7Q29tcG9uZW50fSBjb21wb25lbnRcbiAgICovXG4gIGRpc3BhdGNoRXZlbnQoZXZlbnROYW1lLCBlbnRpdHksIGNvbXBvbmVudCkge1xuICAgIHRoaXMuc3RhdHMuZmlyZWQrKztcblxuICAgIHZhciBsaXN0ZW5lckFycmF5ID0gdGhpcy5fbGlzdGVuZXJzW2V2ZW50TmFtZV07XG4gICAgaWYgKGxpc3RlbmVyQXJyYXkgIT09IHVuZGVmaW5lZCkge1xuICAgICAgdmFyIGFycmF5ID0gbGlzdGVuZXJBcnJheS5zbGljZSgwKTtcblxuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcnJheS5sZW5ndGg7IGkrKykge1xuICAgICAgICBhcnJheVtpXS5jYWxsKHRoaXMsIGVudGl0eSwgY29tcG9uZW50KTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogUmVzZXQgc3RhdHMgY291bnRlcnNcbiAgICovXG4gIHJlc2V0Q291bnRlcnMoKSB7XG4gICAgdGhpcy5zdGF0cy5maXJlZCA9IHRoaXMuc3RhdHMuaGFuZGxlZCA9IDA7XG4gIH1cbn1cbiIsIi8qKlxuICogUmV0dXJuIHRoZSBuYW1lIG9mIGEgY29tcG9uZW50XG4gKiBAcGFyYW0ge0NvbXBvbmVudH0gQ29tcG9uZW50XG4gKiBAcHJpdmF0ZVxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0TmFtZShDb21wb25lbnQpIHtcbiAgcmV0dXJuIENvbXBvbmVudC5uYW1lO1xufVxuXG4vKipcbiAqIFJldHVybiBhIHZhbGlkIHByb3BlcnR5IG5hbWUgZm9yIHRoZSBDb21wb25lbnRcbiAqIEBwYXJhbSB7Q29tcG9uZW50fSBDb21wb25lbnRcbiAqIEBwcml2YXRlXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjb21wb25lbnRQcm9wZXJ0eU5hbWUoQ29tcG9uZW50KSB7XG4gIHZhciBuYW1lID0gZ2V0TmFtZShDb21wb25lbnQpO1xuICByZXR1cm4gbmFtZS5jaGFyQXQoMCkudG9Mb3dlckNhc2UoKSArIG5hbWUuc2xpY2UoMSk7XG59XG5cbi8qKlxuICogR2V0IGEga2V5IGZyb20gYSBsaXN0IG9mIGNvbXBvbmVudHNcbiAqIEBwYXJhbSB7QXJyYXkoQ29tcG9uZW50KX0gQ29tcG9uZW50cyBBcnJheSBvZiBjb21wb25lbnRzIHRvIGdlbmVyYXRlIHRoZSBrZXlcbiAqIEBwcml2YXRlXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBxdWVyeUtleShDb21wb25lbnRzKSB7XG4gIHZhciBuYW1lcyA9IFtdO1xuICBmb3IgKHZhciBuID0gMDsgbiA8IENvbXBvbmVudHMubGVuZ3RoOyBuKyspIHtcbiAgICB2YXIgVCA9IENvbXBvbmVudHNbbl07XG4gICAgaWYgKHR5cGVvZiBUID09PSBcIm9iamVjdFwiKSB7XG4gICAgICB2YXIgb3BlcmF0b3IgPSBULm9wZXJhdG9yID09PSBcIm5vdFwiID8gXCIhXCIgOiBULm9wZXJhdG9yO1xuICAgICAgbmFtZXMucHVzaChvcGVyYXRvciArIGdldE5hbWUoVC5Db21wb25lbnQpKTtcbiAgICB9IGVsc2Uge1xuICAgICAgbmFtZXMucHVzaChnZXROYW1lKFQpKTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gbmFtZXNcbiAgICAubWFwKGZ1bmN0aW9uKHgpIHtcbiAgICAgIHJldHVybiB4LnRvTG93ZXJDYXNlKCk7XG4gICAgfSlcbiAgICAuc29ydCgpXG4gICAgLmpvaW4oXCItXCIpO1xufVxuIiwiaW1wb3J0IEV2ZW50RGlzcGF0Y2hlciBmcm9tIFwiLi9FdmVudERpc3BhdGNoZXIuanNcIjtcbmltcG9ydCB7IHF1ZXJ5S2V5IH0gZnJvbSBcIi4vVXRpbHMuanNcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUXVlcnkge1xuICAvKipcbiAgICogQHBhcmFtIHtBcnJheShDb21wb25lbnQpfSBDb21wb25lbnRzIExpc3Qgb2YgdHlwZXMgb2YgY29tcG9uZW50cyB0byBxdWVyeVxuICAgKi9cbiAgY29uc3RydWN0b3IoQ29tcG9uZW50cywgbWFuYWdlcikge1xuICAgIHRoaXMuQ29tcG9uZW50cyA9IFtdO1xuICAgIHRoaXMuTm90Q29tcG9uZW50cyA9IFtdO1xuXG4gICAgQ29tcG9uZW50cy5mb3JFYWNoKGNvbXBvbmVudCA9PiB7XG4gICAgICBpZiAodHlwZW9mIGNvbXBvbmVudCA9PT0gXCJvYmplY3RcIikge1xuICAgICAgICB0aGlzLk5vdENvbXBvbmVudHMucHVzaChjb21wb25lbnQuQ29tcG9uZW50KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuQ29tcG9uZW50cy5wdXNoKGNvbXBvbmVudCk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBpZiAodGhpcy5Db21wb25lbnRzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiQ2FuJ3QgY3JlYXRlIGEgcXVlcnkgd2l0aG91dCBjb21wb25lbnRzXCIpO1xuICAgIH1cblxuICAgIHRoaXMuZW50aXRpZXMgPSBbXTtcblxuICAgIHRoaXMuZXZlbnREaXNwYXRjaGVyID0gbmV3IEV2ZW50RGlzcGF0Y2hlcigpO1xuXG4gICAgLy8gVGhpcyBxdWVyeSBpcyBiZWluZyB1c2VkIGJ5IGEgcmVhY3RpdmUgc3lzdGVtXG4gICAgdGhpcy5yZWFjdGl2ZSA9IGZhbHNlO1xuXG4gICAgdGhpcy5rZXkgPSBxdWVyeUtleShDb21wb25lbnRzKTtcblxuICAgIC8vIEZpbGwgdGhlIHF1ZXJ5IHdpdGggdGhlIGV4aXN0aW5nIGVudGl0aWVzXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBtYW5hZ2VyLl9lbnRpdGllcy5sZW5ndGg7IGkrKykge1xuICAgICAgdmFyIGVudGl0eSA9IG1hbmFnZXIuX2VudGl0aWVzW2ldO1xuICAgICAgaWYgKHRoaXMubWF0Y2goZW50aXR5KSkge1xuICAgICAgICAvLyBAdG9kbyA/Pz8gdGhpcy5hZGRFbnRpdHkoZW50aXR5KTsgPT4gcHJldmVudGluZyB0aGUgZXZlbnQgdG8gYmUgZ2VuZXJhdGVkXG4gICAgICAgIGVudGl0eS5xdWVyaWVzLnB1c2godGhpcyk7XG4gICAgICAgIHRoaXMuZW50aXRpZXMucHVzaChlbnRpdHkpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBBZGQgZW50aXR5IHRvIHRoaXMgcXVlcnlcbiAgICogQHBhcmFtIHtFbnRpdHl9IGVudGl0eVxuICAgKi9cbiAgYWRkRW50aXR5KGVudGl0eSkge1xuICAgIGVudGl0eS5xdWVyaWVzLnB1c2godGhpcyk7XG4gICAgdGhpcy5lbnRpdGllcy5wdXNoKGVudGl0eSk7XG5cbiAgICB0aGlzLmV2ZW50RGlzcGF0Y2hlci5kaXNwYXRjaEV2ZW50KFF1ZXJ5LnByb3RvdHlwZS5FTlRJVFlfQURERUQsIGVudGl0eSk7XG4gIH1cblxuICAvKipcbiAgICogUmVtb3ZlIGVudGl0eSBmcm9tIHRoaXMgcXVlcnlcbiAgICogQHBhcmFtIHtFbnRpdHl9IGVudGl0eVxuICAgKi9cbiAgcmVtb3ZlRW50aXR5KGVudGl0eSkge1xuICAgIGxldCBpbmRleCA9IHRoaXMuZW50aXRpZXMuaW5kZXhPZihlbnRpdHkpO1xuICAgIGlmICh+aW5kZXgpIHtcbiAgICAgIHRoaXMuZW50aXRpZXMuc3BsaWNlKGluZGV4LCAxKTtcblxuICAgICAgaW5kZXggPSBlbnRpdHkucXVlcmllcy5pbmRleE9mKHRoaXMpO1xuICAgICAgZW50aXR5LnF1ZXJpZXMuc3BsaWNlKGluZGV4LCAxKTtcblxuICAgICAgdGhpcy5ldmVudERpc3BhdGNoZXIuZGlzcGF0Y2hFdmVudChcbiAgICAgICAgUXVlcnkucHJvdG90eXBlLkVOVElUWV9SRU1PVkVELFxuICAgICAgICBlbnRpdHlcbiAgICAgICk7XG4gICAgfVxuICB9XG5cbiAgbWF0Y2goZW50aXR5KSB7XG4gICAgcmV0dXJuIChcbiAgICAgIGVudGl0eS5oYXNBbGxDb21wb25lbnRzKHRoaXMuQ29tcG9uZW50cykgJiZcbiAgICAgICFlbnRpdHkuaGFzQW55Q29tcG9uZW50cyh0aGlzLk5vdENvbXBvbmVudHMpXG4gICAgKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXR1cm4gc3RhdHMgZm9yIHRoaXMgcXVlcnlcbiAgICovXG4gIHN0YXRzKCkge1xuICAgIHJldHVybiB7XG4gICAgICBudW1Db21wb25lbnRzOiB0aGlzLkNvbXBvbmVudHMubGVuZ3RoLFxuICAgICAgbnVtRW50aXRpZXM6IHRoaXMuZW50aXRpZXMubGVuZ3RoXG4gICAgfTtcbiAgfVxufVxuXG5RdWVyeS5wcm90b3R5cGUuRU5USVRZX0FEREVEID0gXCJRdWVyeSNFTlRJVFlfQURERURcIjtcblF1ZXJ5LnByb3RvdHlwZS5FTlRJVFlfUkVNT1ZFRCA9IFwiUXVlcnkjRU5USVRZX1JFTU9WRURcIjtcblF1ZXJ5LnByb3RvdHlwZS5DT01QT05FTlRfQ0hBTkdFRCA9IFwiUXVlcnkjQ09NUE9ORU5UX0NIQU5HRURcIjtcbiIsImltcG9ydCBRdWVyeSBmcm9tIFwiLi9RdWVyeS5qc1wiO1xuaW1wb3J0IHdyYXBJbW11dGFibGVDb21wb25lbnQgZnJvbSBcIi4vV3JhcEltbXV0YWJsZUNvbXBvbmVudC5qc1wiO1xuXG4vLyBAdG9kbyBUYWtlIHRoaXMgb3V0IGZyb20gdGhlcmUgb3IgdXNlIEVOVlxuY29uc3QgREVCVUcgPSBmYWxzZTtcblxudmFyIG5leHRJZCA9IDA7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEVudGl0eSB7XG4gIGNvbnN0cnVjdG9yKHdvcmxkKSB7XG4gICAgdGhpcy5fd29ybGQgPSB3b3JsZCB8fCBudWxsO1xuXG4gICAgLy8gVW5pcXVlIElEIGZvciB0aGlzIGVudGl0eVxuICAgIHRoaXMuaWQgPSBuZXh0SWQrKztcblxuICAgIC8vIExpc3Qgb2YgY29tcG9uZW50cyB0eXBlcyB0aGUgZW50aXR5IGhhc1xuICAgIHRoaXMuX0NvbXBvbmVudFR5cGVzID0gW107XG5cbiAgICAvLyBJbnN0YW5jZSBvZiB0aGUgY29tcG9uZW50c1xuICAgIHRoaXMuX2NvbXBvbmVudHMgPSB7fTtcblxuICAgIHRoaXMuX2NvbXBvbmVudHNUb1JlbW92ZSA9IHt9O1xuXG4gICAgLy8gUXVlcmllcyB3aGVyZSB0aGUgZW50aXR5IGlzIGFkZGVkXG4gICAgdGhpcy5xdWVyaWVzID0gW107XG5cbiAgICAvLyBVc2VkIGZvciBkZWZlcnJlZCByZW1vdmFsXG4gICAgdGhpcy5fQ29tcG9uZW50VHlwZXNUb1JlbW92ZSA9IFtdO1xuXG4gICAgdGhpcy5hbGl2ZSA9IGZhbHNlO1xuICB9XG5cbiAgLy8gQ09NUE9ORU5UU1xuXG4gIGdldENvbXBvbmVudChDb21wb25lbnQpIHtcbiAgICB2YXIgY29tcG9uZW50ID0gdGhpcy5fY29tcG9uZW50c1tDb21wb25lbnQubmFtZV07XG4gICAgcmV0dXJuIERFQlVHID8gd3JhcEltbXV0YWJsZUNvbXBvbmVudChDb21wb25lbnQsIGNvbXBvbmVudCkgOiBjb21wb25lbnQ7XG4gIH1cblxuICBnZXRSZW1vdmVkQ29tcG9uZW50KENvbXBvbmVudCkge1xuICAgIHJldHVybiB0aGlzLl9jb21wb25lbnRzVG9SZW1vdmVbQ29tcG9uZW50Lm5hbWVdO1xuICB9XG5cbiAgZ2V0Q29tcG9uZW50cygpIHtcbiAgICByZXR1cm4gdGhpcy5fY29tcG9uZW50cztcbiAgfVxuXG4gIGdldENvbXBvbmVudHNUb1JlbW92ZSgpIHtcbiAgICByZXR1cm4gdGhpcy5fY29tcG9uZW50c1RvUmVtb3ZlO1xuICB9XG5cbiAgZ2V0Q29tcG9uZW50VHlwZXMoKSB7XG4gICAgcmV0dXJuIHRoaXMuX0NvbXBvbmVudFR5cGVzO1xuICB9XG5cbiAgZ2V0TXV0YWJsZUNvbXBvbmVudChDb21wb25lbnQpIHtcbiAgICB2YXIgY29tcG9uZW50ID0gdGhpcy5fY29tcG9uZW50c1tDb21wb25lbnQubmFtZV07XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLnF1ZXJpZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgIHZhciBxdWVyeSA9IHRoaXMucXVlcmllc1tpXTtcbiAgICAgIC8vIEB0b2RvIGFjY2VsZXJhdGUgdGhpcyBjaGVjay4gTWF5YmUgaGF2aW5nIHF1ZXJ5Ll9Db21wb25lbnRzIGFzIGFuIG9iamVjdFxuICAgICAgaWYgKHF1ZXJ5LnJlYWN0aXZlICYmIHF1ZXJ5LkNvbXBvbmVudHMuaW5kZXhPZihDb21wb25lbnQpICE9PSAtMSkge1xuICAgICAgICBxdWVyeS5ldmVudERpc3BhdGNoZXIuZGlzcGF0Y2hFdmVudChcbiAgICAgICAgICBRdWVyeS5wcm90b3R5cGUuQ09NUE9ORU5UX0NIQU5HRUQsXG4gICAgICAgICAgdGhpcyxcbiAgICAgICAgICBjb21wb25lbnRcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGNvbXBvbmVudDtcbiAgfVxuXG4gIGFkZENvbXBvbmVudChDb21wb25lbnQsIHZhbHVlcykge1xuICAgIHRoaXMuX3dvcmxkLmVudGl0eUFkZENvbXBvbmVudCh0aGlzLCBDb21wb25lbnQsIHZhbHVlcyk7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICByZW1vdmVDb21wb25lbnQoQ29tcG9uZW50LCBmb3JjZVJlbW92ZSkge1xuICAgIHRoaXMuX3dvcmxkLmVudGl0eVJlbW92ZUNvbXBvbmVudCh0aGlzLCBDb21wb25lbnQsIGZvcmNlUmVtb3ZlKTtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIGhhc0NvbXBvbmVudChDb21wb25lbnQpIHtcbiAgICByZXR1cm4gISF+dGhpcy5fQ29tcG9uZW50VHlwZXMuaW5kZXhPZihDb21wb25lbnQpO1xuICB9XG5cbiAgaGFzUmVtb3ZlZENvbXBvbmVudChDb21wb25lbnQpIHtcbiAgICByZXR1cm4gISF+dGhpcy5fQ29tcG9uZW50VHlwZXNUb1JlbW92ZS5pbmRleE9mKENvbXBvbmVudCk7XG4gIH1cblxuICBoYXNBbGxDb21wb25lbnRzKENvbXBvbmVudHMpIHtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IENvbXBvbmVudHMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGlmICghdGhpcy5oYXNDb21wb25lbnQoQ29tcG9uZW50c1tpXSkpIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cblxuICBoYXNBbnlDb21wb25lbnRzKENvbXBvbmVudHMpIHtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IENvbXBvbmVudHMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGlmICh0aGlzLmhhc0NvbXBvbmVudChDb21wb25lbnRzW2ldKSkgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuXG4gIHJlbW92ZUFsbENvbXBvbmVudHMoZm9yY2VSZW1vdmUpIHtcbiAgICByZXR1cm4gdGhpcy5fd29ybGQuZW50aXR5UmVtb3ZlQWxsQ29tcG9uZW50cyh0aGlzLCBmb3JjZVJlbW92ZSk7XG4gIH1cblxuICAvLyBFWFRSQVNcblxuICAvLyBJbml0aWFsaXplIHRoZSBlbnRpdHkuIFRvIGJlIHVzZWQgd2hlbiByZXR1cm5pbmcgYW4gZW50aXR5IHRvIHRoZSBwb29sXG4gIHJlc2V0KCkge1xuICAgIHRoaXMuaWQgPSBuZXh0SWQrKztcbiAgICB0aGlzLl93b3JsZCA9IG51bGw7XG4gICAgdGhpcy5fQ29tcG9uZW50VHlwZXMubGVuZ3RoID0gMDtcbiAgICB0aGlzLnF1ZXJpZXMubGVuZ3RoID0gMDtcbiAgICB0aGlzLl9jb21wb25lbnRzID0ge307XG4gIH1cblxuICByZW1vdmUoZm9yY2VSZW1vdmUpIHtcbiAgICByZXR1cm4gdGhpcy5fd29ybGQucmVtb3ZlRW50aXR5KHRoaXMsIGZvcmNlUmVtb3ZlKTtcbiAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgT2JqZWN0UG9vbCB7XG4gIC8vIEB0b2RvIEFkZCBpbml0aWFsIHNpemVcbiAgY29uc3RydWN0b3IoVCwgaW5pdGlhbFNpemUpIHtcbiAgICB0aGlzLmZyZWVMaXN0ID0gW107XG4gICAgdGhpcy5jb3VudCA9IDA7XG4gICAgdGhpcy5UID0gVDtcblxuICAgIHZhciBleHRyYUFyZ3MgPSBudWxsO1xuICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID4gMSkge1xuICAgICAgZXh0cmFBcmdzID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzKTtcbiAgICAgIGV4dHJhQXJncy5zaGlmdCgpO1xuICAgIH1cblxuICAgIHRoaXMuY3JlYXRlRWxlbWVudCA9IGV4dHJhQXJnc1xuICAgICAgPyAoKSA9PiB7XG4gICAgICAgICAgcmV0dXJuIG5ldyBUKC4uLmV4dHJhQXJncyk7XG4gICAgICAgIH1cbiAgICAgIDogKCkgPT4ge1xuICAgICAgICAgIHJldHVybiBuZXcgVCgpO1xuICAgICAgICB9O1xuXG4gICAgaWYgKHR5cGVvZiBpbml0aWFsU2l6ZSAhPT0gXCJ1bmRlZmluZWRcIikge1xuICAgICAgdGhpcy5leHBhbmQoaW5pdGlhbFNpemUpO1xuICAgIH1cbiAgfVxuXG4gIGFxdWlyZSgpIHtcbiAgICAvLyBHcm93IHRoZSBsaXN0IGJ5IDIwJWlzaCBpZiB3ZSdyZSBvdXRcbiAgICBpZiAodGhpcy5mcmVlTGlzdC5sZW5ndGggPD0gMCkge1xuICAgICAgdGhpcy5leHBhbmQoTWF0aC5yb3VuZCh0aGlzLmNvdW50ICogMC4yKSArIDEpO1xuICAgIH1cblxuICAgIHZhciBpdGVtID0gdGhpcy5mcmVlTGlzdC5wb3AoKTtcblxuICAgIHJldHVybiBpdGVtO1xuICB9XG5cbiAgcmVsZWFzZShpdGVtKSB7XG4gICAgaXRlbS5yZXNldCgpO1xuICAgIHRoaXMuZnJlZUxpc3QucHVzaChpdGVtKTtcbiAgfVxuXG4gIGV4cGFuZChjb3VudCkge1xuICAgIGZvciAodmFyIG4gPSAwOyBuIDwgY291bnQ7IG4rKykge1xuICAgICAgdGhpcy5mcmVlTGlzdC5wdXNoKHRoaXMuY3JlYXRlRWxlbWVudCgpKTtcbiAgICB9XG4gICAgdGhpcy5jb3VudCArPSBjb3VudDtcbiAgfVxuXG4gIHRvdGFsU2l6ZSgpIHtcbiAgICByZXR1cm4gdGhpcy5jb3VudDtcbiAgfVxuXG4gIHRvdGFsRnJlZSgpIHtcbiAgICByZXR1cm4gdGhpcy5mcmVlTGlzdC5sZW5ndGg7XG4gIH1cblxuICB0b3RhbFVzZWQoKSB7XG4gICAgcmV0dXJuIHRoaXMuY291bnQgLSB0aGlzLmZyZWVMaXN0Lmxlbmd0aDtcbiAgfVxufVxuIiwiaW1wb3J0IFF1ZXJ5IGZyb20gXCIuL1F1ZXJ5LmpzXCI7XG5pbXBvcnQgeyBxdWVyeUtleSB9IGZyb20gXCIuL1V0aWxzLmpzXCI7XG5cbi8qKlxuICogQHByaXZhdGVcbiAqIEBjbGFzcyBRdWVyeU1hbmFnZXJcbiAqL1xuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUXVlcnlNYW5hZ2VyIHtcbiAgY29uc3RydWN0b3Iod29ybGQpIHtcbiAgICB0aGlzLl93b3JsZCA9IHdvcmxkO1xuXG4gICAgLy8gUXVlcmllcyBpbmRleGVkIGJ5IGEgdW5pcXVlIGlkZW50aWZpZXIgZm9yIHRoZSBjb21wb25lbnRzIGl0IGhhc1xuICAgIHRoaXMuX3F1ZXJpZXMgPSB7fTtcbiAgfVxuXG4gIG9uRW50aXR5UmVtb3ZlZChlbnRpdHkpIHtcbiAgICBmb3IgKHZhciBxdWVyeU5hbWUgaW4gdGhpcy5fcXVlcmllcykge1xuICAgICAgdmFyIHF1ZXJ5ID0gdGhpcy5fcXVlcmllc1txdWVyeU5hbWVdO1xuICAgICAgaWYgKGVudGl0eS5xdWVyaWVzLmluZGV4T2YocXVlcnkpICE9PSAtMSkge1xuICAgICAgICBxdWVyeS5yZW1vdmVFbnRpdHkoZW50aXR5KTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQ2FsbGJhY2sgd2hlbiBhIGNvbXBvbmVudCBpcyBhZGRlZCB0byBhbiBlbnRpdHlcbiAgICogQHBhcmFtIHtFbnRpdHl9IGVudGl0eSBFbnRpdHkgdGhhdCBqdXN0IGdvdCB0aGUgbmV3IGNvbXBvbmVudFxuICAgKiBAcGFyYW0ge0NvbXBvbmVudH0gQ29tcG9uZW50IENvbXBvbmVudCBhZGRlZCB0byB0aGUgZW50aXR5XG4gICAqL1xuICBvbkVudGl0eUNvbXBvbmVudEFkZGVkKGVudGl0eSwgQ29tcG9uZW50KSB7XG4gICAgLy8gQHRvZG8gVXNlIGJpdG1hc2sgZm9yIGNoZWNraW5nIGNvbXBvbmVudHM/XG5cbiAgICAvLyBDaGVjayBlYWNoIGluZGV4ZWQgcXVlcnkgdG8gc2VlIGlmIHdlIG5lZWQgdG8gYWRkIHRoaXMgZW50aXR5IHRvIHRoZSBsaXN0XG4gICAgZm9yICh2YXIgcXVlcnlOYW1lIGluIHRoaXMuX3F1ZXJpZXMpIHtcbiAgICAgIHZhciBxdWVyeSA9IHRoaXMuX3F1ZXJpZXNbcXVlcnlOYW1lXTtcblxuICAgICAgaWYgKFxuICAgICAgICAhIX5xdWVyeS5Ob3RDb21wb25lbnRzLmluZGV4T2YoQ29tcG9uZW50KSAmJlxuICAgICAgICB+cXVlcnkuZW50aXRpZXMuaW5kZXhPZihlbnRpdHkpXG4gICAgICApIHtcbiAgICAgICAgcXVlcnkucmVtb3ZlRW50aXR5KGVudGl0eSk7XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfVxuXG4gICAgICAvLyBBZGQgdGhlIGVudGl0eSBvbmx5IGlmOlxuICAgICAgLy8gQ29tcG9uZW50IGlzIGluIHRoZSBxdWVyeVxuICAgICAgLy8gYW5kIEVudGl0eSBoYXMgQUxMIHRoZSBjb21wb25lbnRzIG9mIHRoZSBxdWVyeVxuICAgICAgLy8gYW5kIEVudGl0eSBpcyBub3QgYWxyZWFkeSBpbiB0aGUgcXVlcnlcbiAgICAgIGlmIChcbiAgICAgICAgIX5xdWVyeS5Db21wb25lbnRzLmluZGV4T2YoQ29tcG9uZW50KSB8fFxuICAgICAgICAhcXVlcnkubWF0Y2goZW50aXR5KSB8fFxuICAgICAgICB+cXVlcnkuZW50aXRpZXMuaW5kZXhPZihlbnRpdHkpXG4gICAgICApXG4gICAgICAgIGNvbnRpbnVlO1xuXG4gICAgICBxdWVyeS5hZGRFbnRpdHkoZW50aXR5KTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQ2FsbGJhY2sgd2hlbiBhIGNvbXBvbmVudCBpcyByZW1vdmVkIGZyb20gYW4gZW50aXR5XG4gICAqIEBwYXJhbSB7RW50aXR5fSBlbnRpdHkgRW50aXR5IHRvIHJlbW92ZSB0aGUgY29tcG9uZW50IGZyb21cbiAgICogQHBhcmFtIHtDb21wb25lbnR9IENvbXBvbmVudCBDb21wb25lbnQgdG8gcmVtb3ZlIGZyb20gdGhlIGVudGl0eVxuICAgKi9cbiAgb25FbnRpdHlDb21wb25lbnRSZW1vdmVkKGVudGl0eSwgQ29tcG9uZW50KSB7XG4gICAgZm9yICh2YXIgcXVlcnlOYW1lIGluIHRoaXMuX3F1ZXJpZXMpIHtcbiAgICAgIHZhciBxdWVyeSA9IHRoaXMuX3F1ZXJpZXNbcXVlcnlOYW1lXTtcblxuICAgICAgaWYgKFxuICAgICAgICAhIX5xdWVyeS5Ob3RDb21wb25lbnRzLmluZGV4T2YoQ29tcG9uZW50KSAmJlxuICAgICAgICAhfnF1ZXJ5LmVudGl0aWVzLmluZGV4T2YoZW50aXR5KSAmJlxuICAgICAgICBxdWVyeS5tYXRjaChlbnRpdHkpXG4gICAgICApIHtcbiAgICAgICAgcXVlcnkuYWRkRW50aXR5KGVudGl0eSk7XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfVxuXG4gICAgICBpZiAoXG4gICAgICAgICEhfnF1ZXJ5LkNvbXBvbmVudHMuaW5kZXhPZihDb21wb25lbnQpICYmXG4gICAgICAgICEhfnF1ZXJ5LmVudGl0aWVzLmluZGV4T2YoZW50aXR5KSAmJlxuICAgICAgICAhcXVlcnkubWF0Y2goZW50aXR5KVxuICAgICAgKSB7XG4gICAgICAgIHF1ZXJ5LnJlbW92ZUVudGl0eShlbnRpdHkpO1xuICAgICAgICBjb250aW51ZTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogR2V0IGEgcXVlcnkgZm9yIHRoZSBzcGVjaWZpZWQgY29tcG9uZW50c1xuICAgKiBAcGFyYW0ge0NvbXBvbmVudH0gQ29tcG9uZW50cyBDb21wb25lbnRzIHRoYXQgdGhlIHF1ZXJ5IHNob3VsZCBoYXZlXG4gICAqL1xuICBnZXRRdWVyeShDb21wb25lbnRzKSB7XG4gICAgdmFyIGtleSA9IHF1ZXJ5S2V5KENvbXBvbmVudHMpO1xuICAgIHZhciBxdWVyeSA9IHRoaXMuX3F1ZXJpZXNba2V5XTtcbiAgICBpZiAoIXF1ZXJ5KSB7XG4gICAgICB0aGlzLl9xdWVyaWVzW2tleV0gPSBxdWVyeSA9IG5ldyBRdWVyeShDb21wb25lbnRzLCB0aGlzLl93b3JsZCk7XG4gICAgfVxuICAgIHJldHVybiBxdWVyeTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXR1cm4gc29tZSBzdGF0cyBmcm9tIHRoaXMgY2xhc3NcbiAgICovXG4gIHN0YXRzKCkge1xuICAgIHZhciBzdGF0cyA9IHt9O1xuICAgIGZvciAodmFyIHF1ZXJ5TmFtZSBpbiB0aGlzLl9xdWVyaWVzKSB7XG4gICAgICBzdGF0c1txdWVyeU5hbWVdID0gdGhpcy5fcXVlcmllc1txdWVyeU5hbWVdLnN0YXRzKCk7XG4gICAgfVxuICAgIHJldHVybiBzdGF0cztcbiAgfVxufVxuIiwiZXhwb3J0IGNsYXNzIFN5c3RlbVN0YXRlQ29tcG9uZW50IHt9XG4iLCJpbXBvcnQgRW50aXR5IGZyb20gXCIuL0VudGl0eS5qc1wiO1xuaW1wb3J0IE9iamVjdFBvb2wgZnJvbSBcIi4vT2JqZWN0UG9vbC5qc1wiO1xuaW1wb3J0IFF1ZXJ5TWFuYWdlciBmcm9tIFwiLi9RdWVyeU1hbmFnZXIuanNcIjtcbmltcG9ydCBFdmVudERpc3BhdGNoZXIgZnJvbSBcIi4vRXZlbnREaXNwYXRjaGVyLmpzXCI7XG5pbXBvcnQgeyBjb21wb25lbnRQcm9wZXJ0eU5hbWUsIGdldE5hbWUgfSBmcm9tIFwiLi9VdGlscy5qc1wiO1xuaW1wb3J0IHsgU3lzdGVtU3RhdGVDb21wb25lbnQgfSBmcm9tIFwiLi9TeXN0ZW1TdGF0ZUNvbXBvbmVudC5qc1wiO1xuXG4vKipcbiAqIEBwcml2YXRlXG4gKiBAY2xhc3MgRW50aXR5TWFuYWdlclxuICovXG5leHBvcnQgY2xhc3MgRW50aXR5TWFuYWdlciB7XG4gIGNvbnN0cnVjdG9yKHdvcmxkKSB7XG4gICAgdGhpcy53b3JsZCA9IHdvcmxkO1xuICAgIHRoaXMuY29tcG9uZW50c01hbmFnZXIgPSB3b3JsZC5jb21wb25lbnRzTWFuYWdlcjtcblxuICAgIC8vIEFsbCB0aGUgZW50aXRpZXMgaW4gdGhpcyBpbnN0YW5jZVxuICAgIHRoaXMuX2VudGl0aWVzID0gW107XG5cbiAgICB0aGlzLl9xdWVyeU1hbmFnZXIgPSBuZXcgUXVlcnlNYW5hZ2VyKHRoaXMpO1xuICAgIHRoaXMuZXZlbnREaXNwYXRjaGVyID0gbmV3IEV2ZW50RGlzcGF0Y2hlcigpO1xuICAgIHRoaXMuX2VudGl0eVBvb2wgPSBuZXcgT2JqZWN0UG9vbChFbnRpdHkpO1xuXG4gICAgLy8gRGVmZXJyZWQgZGVsZXRpb25cbiAgICB0aGlzLmVudGl0aWVzV2l0aENvbXBvbmVudHNUb1JlbW92ZSA9IFtdO1xuICAgIHRoaXMuZW50aXRpZXNUb1JlbW92ZSA9IFtdO1xuXG4gICAgdGhpcy5udW1TdGF0ZUNvbXBvbmVudHMgPSAwO1xuICB9XG5cbiAgLyoqXG4gICAqIENyZWF0ZSBhIG5ldyBlbnRpdHlcbiAgICovXG4gIGNyZWF0ZUVudGl0eSgpIHtcbiAgICB2YXIgZW50aXR5ID0gdGhpcy5fZW50aXR5UG9vbC5hcXVpcmUoKTtcbiAgICBlbnRpdHkuYWxpdmUgPSB0cnVlO1xuICAgIGVudGl0eS5fd29ybGQgPSB0aGlzO1xuICAgIHRoaXMuX2VudGl0aWVzLnB1c2goZW50aXR5KTtcbiAgICB0aGlzLmV2ZW50RGlzcGF0Y2hlci5kaXNwYXRjaEV2ZW50KEVOVElUWV9DUkVBVEVELCBlbnRpdHkpO1xuICAgIHJldHVybiBlbnRpdHk7XG4gIH1cblxuICAvLyBDT01QT05FTlRTXG5cbiAgLyoqXG4gICAqIEFkZCBhIGNvbXBvbmVudCB0byBhbiBlbnRpdHlcbiAgICogQHBhcmFtIHtFbnRpdHl9IGVudGl0eSBFbnRpdHkgd2hlcmUgdGhlIGNvbXBvbmVudCB3aWxsIGJlIGFkZGVkXG4gICAqIEBwYXJhbSB7Q29tcG9uZW50fSBDb21wb25lbnQgQ29tcG9uZW50IHRvIGJlIGFkZGVkIHRvIHRoZSBlbnRpdHlcbiAgICogQHBhcmFtIHtPYmplY3R9IHZhbHVlcyBPcHRpb25hbCB2YWx1ZXMgdG8gcmVwbGFjZSB0aGUgZGVmYXVsdCBhdHRyaWJ1dGVzXG4gICAqL1xuICBlbnRpdHlBZGRDb21wb25lbnQoZW50aXR5LCBDb21wb25lbnQsIHZhbHVlcykge1xuICAgIGlmICh+ZW50aXR5Ll9Db21wb25lbnRUeXBlcy5pbmRleE9mKENvbXBvbmVudCkpIHJldHVybjtcblxuICAgIGVudGl0eS5fQ29tcG9uZW50VHlwZXMucHVzaChDb21wb25lbnQpO1xuXG4gICAgaWYgKENvbXBvbmVudC5fX3Byb3RvX18gPT09IFN5c3RlbVN0YXRlQ29tcG9uZW50KSB7XG4gICAgICB0aGlzLm51bVN0YXRlQ29tcG9uZW50cysrO1xuICAgIH1cblxuICAgIHZhciBjb21wb25lbnRQb29sID0gdGhpcy53b3JsZC5jb21wb25lbnRzTWFuYWdlci5nZXRDb21wb25lbnRzUG9vbChcbiAgICAgIENvbXBvbmVudFxuICAgICk7XG4gICAgdmFyIGNvbXBvbmVudCA9IGNvbXBvbmVudFBvb2wuYXF1aXJlKCk7XG5cbiAgICBlbnRpdHkuX2NvbXBvbmVudHNbQ29tcG9uZW50Lm5hbWVdID0gY29tcG9uZW50O1xuXG4gICAgaWYgKHZhbHVlcykge1xuICAgICAgaWYgKGNvbXBvbmVudC5jb3B5KSB7XG4gICAgICAgIGNvbXBvbmVudC5jb3B5KHZhbHVlcyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBmb3IgKHZhciBuYW1lIGluIHZhbHVlcykge1xuICAgICAgICAgIGNvbXBvbmVudFtuYW1lXSA9IHZhbHVlc1tuYW1lXTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIHRoaXMuX3F1ZXJ5TWFuYWdlci5vbkVudGl0eUNvbXBvbmVudEFkZGVkKGVudGl0eSwgQ29tcG9uZW50KTtcbiAgICB0aGlzLndvcmxkLmNvbXBvbmVudHNNYW5hZ2VyLmNvbXBvbmVudEFkZGVkVG9FbnRpdHkoQ29tcG9uZW50KTtcblxuICAgIHRoaXMuZXZlbnREaXNwYXRjaGVyLmRpc3BhdGNoRXZlbnQoQ09NUE9ORU5UX0FEREVELCBlbnRpdHksIENvbXBvbmVudCk7XG4gIH1cblxuICAvKipcbiAgICogUmVtb3ZlIGEgY29tcG9uZW50IGZyb20gYW4gZW50aXR5XG4gICAqIEBwYXJhbSB7RW50aXR5fSBlbnRpdHkgRW50aXR5IHdoaWNoIHdpbGwgZ2V0IHJlbW92ZWQgdGhlIGNvbXBvbmVudFxuICAgKiBAcGFyYW0geyp9IENvbXBvbmVudCBDb21wb25lbnQgdG8gcmVtb3ZlIGZyb20gdGhlIGVudGl0eVxuICAgKiBAcGFyYW0ge0Jvb2x9IGltbWVkaWF0ZWx5IElmIHlvdSB3YW50IHRvIHJlbW92ZSB0aGUgY29tcG9uZW50IGltbWVkaWF0ZWx5IGluc3RlYWQgb2YgZGVmZXJyZWQgKERlZmF1bHQgaXMgZmFsc2UpXG4gICAqL1xuICBlbnRpdHlSZW1vdmVDb21wb25lbnQoZW50aXR5LCBDb21wb25lbnQsIGltbWVkaWF0ZWx5KSB7XG4gICAgdmFyIGluZGV4ID0gZW50aXR5Ll9Db21wb25lbnRUeXBlcy5pbmRleE9mKENvbXBvbmVudCk7XG4gICAgaWYgKCF+aW5kZXgpIHJldHVybjtcblxuICAgIHRoaXMuZXZlbnREaXNwYXRjaGVyLmRpc3BhdGNoRXZlbnQoQ09NUE9ORU5UX1JFTU9WRSwgZW50aXR5LCBDb21wb25lbnQpO1xuXG4gICAgaWYgKGltbWVkaWF0ZWx5KSB7XG4gICAgICB0aGlzLl9lbnRpdHlSZW1vdmVDb21wb25lbnRTeW5jKGVudGl0eSwgQ29tcG9uZW50LCBpbmRleCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGlmIChlbnRpdHkuX0NvbXBvbmVudFR5cGVzVG9SZW1vdmUubGVuZ3RoID09PSAwKVxuICAgICAgICB0aGlzLmVudGl0aWVzV2l0aENvbXBvbmVudHNUb1JlbW92ZS5wdXNoKGVudGl0eSk7XG5cbiAgICAgIGVudGl0eS5fQ29tcG9uZW50VHlwZXMuc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgIGVudGl0eS5fQ29tcG9uZW50VHlwZXNUb1JlbW92ZS5wdXNoKENvbXBvbmVudCk7XG5cbiAgICAgIHZhciBjb21wb25lbnROYW1lID0gZ2V0TmFtZShDb21wb25lbnQpO1xuICAgICAgZW50aXR5Ll9jb21wb25lbnRzVG9SZW1vdmVbY29tcG9uZW50TmFtZV0gPVxuICAgICAgICBlbnRpdHkuX2NvbXBvbmVudHNbY29tcG9uZW50TmFtZV07XG4gICAgICBkZWxldGUgZW50aXR5Ll9jb21wb25lbnRzW2NvbXBvbmVudE5hbWVdO1xuICAgIH1cblxuICAgIC8vIENoZWNrIGVhY2ggaW5kZXhlZCBxdWVyeSB0byBzZWUgaWYgd2UgbmVlZCB0byByZW1vdmUgaXRcbiAgICB0aGlzLl9xdWVyeU1hbmFnZXIub25FbnRpdHlDb21wb25lbnRSZW1vdmVkKGVudGl0eSwgQ29tcG9uZW50KTtcblxuICAgIGlmIChDb21wb25lbnQuX19wcm90b19fID09PSBTeXN0ZW1TdGF0ZUNvbXBvbmVudCkge1xuICAgICAgdGhpcy5udW1TdGF0ZUNvbXBvbmVudHMtLTtcblxuICAgICAgLy8gQ2hlY2sgaWYgdGhlIGVudGl0eSB3YXMgYSBnaG9zdCB3YWl0aW5nIGZvciB0aGUgbGFzdCBzeXN0ZW0gc3RhdGUgY29tcG9uZW50IHRvIGJlIHJlbW92ZWRcbiAgICAgIGlmICh0aGlzLm51bVN0YXRlQ29tcG9uZW50cyA9PT0gMCAmJiAhZW50aXR5LmFsaXZlKSB7XG4gICAgICAgIGVudGl0eS5yZW1vdmUoKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBfZW50aXR5UmVtb3ZlQ29tcG9uZW50U3luYyhlbnRpdHksIENvbXBvbmVudCwgaW5kZXgpIHtcbiAgICAvLyBSZW1vdmUgVCBsaXN0aW5nIG9uIGVudGl0eSBhbmQgcHJvcGVydHkgcmVmLCB0aGVuIGZyZWUgdGhlIGNvbXBvbmVudC5cbiAgICBlbnRpdHkuX0NvbXBvbmVudFR5cGVzLnNwbGljZShpbmRleCwgMSk7XG4gICAgdmFyIHByb3BOYW1lID0gY29tcG9uZW50UHJvcGVydHlOYW1lKENvbXBvbmVudCk7XG4gICAgdmFyIGNvbXBvbmVudE5hbWUgPSBnZXROYW1lKENvbXBvbmVudCk7XG4gICAgdmFyIGNvbXBvbmVudCA9IGVudGl0eS5fY29tcG9uZW50c1tjb21wb25lbnROYW1lXTtcbiAgICBkZWxldGUgZW50aXR5Ll9jb21wb25lbnRzW2NvbXBvbmVudE5hbWVdO1xuICAgIHRoaXMuY29tcG9uZW50c01hbmFnZXIuX2NvbXBvbmVudFBvb2xbcHJvcE5hbWVdLnJlbGVhc2UoY29tcG9uZW50KTtcbiAgICB0aGlzLndvcmxkLmNvbXBvbmVudHNNYW5hZ2VyLmNvbXBvbmVudFJlbW92ZWRGcm9tRW50aXR5KENvbXBvbmVudCk7XG4gIH1cblxuICAvKipcbiAgICogUmVtb3ZlIGFsbCB0aGUgY29tcG9uZW50cyBmcm9tIGFuIGVudGl0eVxuICAgKiBAcGFyYW0ge0VudGl0eX0gZW50aXR5IEVudGl0eSBmcm9tIHdoaWNoIHRoZSBjb21wb25lbnRzIHdpbGwgYmUgcmVtb3ZlZFxuICAgKi9cbiAgZW50aXR5UmVtb3ZlQWxsQ29tcG9uZW50cyhlbnRpdHksIGltbWVkaWF0ZWx5KSB7XG4gICAgbGV0IENvbXBvbmVudHMgPSBlbnRpdHkuX0NvbXBvbmVudFR5cGVzO1xuXG4gICAgZm9yIChsZXQgaiA9IENvbXBvbmVudHMubGVuZ3RoIC0gMTsgaiA+PSAwOyBqLS0pIHtcbiAgICAgIGlmIChDb21wb25lbnRzW2pdLl9fcHJvdG9fXyAhPT0gU3lzdGVtU3RhdGVDb21wb25lbnQpXG4gICAgICAgIHRoaXMuZW50aXR5UmVtb3ZlQ29tcG9uZW50KGVudGl0eSwgQ29tcG9uZW50c1tqXSwgaW1tZWRpYXRlbHkpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBSZW1vdmUgdGhlIGVudGl0eSBmcm9tIHRoaXMgbWFuYWdlci4gSXQgd2lsbCBjbGVhciBhbHNvIGl0cyBjb21wb25lbnRzXG4gICAqIEBwYXJhbSB7RW50aXR5fSBlbnRpdHkgRW50aXR5IHRvIHJlbW92ZSBmcm9tIHRoZSBtYW5hZ2VyXG4gICAqIEBwYXJhbSB7Qm9vbH0gaW1tZWRpYXRlbHkgSWYgeW91IHdhbnQgdG8gcmVtb3ZlIHRoZSBjb21wb25lbnQgaW1tZWRpYXRlbHkgaW5zdGVhZCBvZiBkZWZlcnJlZCAoRGVmYXVsdCBpcyBmYWxzZSlcbiAgICovXG4gIHJlbW92ZUVudGl0eShlbnRpdHksIGltbWVkaWF0ZWx5KSB7XG4gICAgdmFyIGluZGV4ID0gdGhpcy5fZW50aXRpZXMuaW5kZXhPZihlbnRpdHkpO1xuXG4gICAgaWYgKCF+aW5kZXgpIHRocm93IG5ldyBFcnJvcihcIlRyaWVkIHRvIHJlbW92ZSBlbnRpdHkgbm90IGluIGxpc3RcIik7XG5cbiAgICBlbnRpdHkuYWxpdmUgPSBmYWxzZTtcblxuICAgIGlmICh0aGlzLm51bVN0YXRlQ29tcG9uZW50cyA9PT0gMCkge1xuICAgICAgLy8gUmVtb3ZlIGZyb20gZW50aXR5IGxpc3RcbiAgICAgIHRoaXMuZXZlbnREaXNwYXRjaGVyLmRpc3BhdGNoRXZlbnQoRU5USVRZX1JFTU9WRUQsIGVudGl0eSk7XG4gICAgICB0aGlzLl9xdWVyeU1hbmFnZXIub25FbnRpdHlSZW1vdmVkKGVudGl0eSk7XG4gICAgICBpZiAoaW1tZWRpYXRlbHkgPT09IHRydWUpIHtcbiAgICAgICAgdGhpcy5fcmVsZWFzZUVudGl0eShlbnRpdHksIGluZGV4KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuZW50aXRpZXNUb1JlbW92ZS5wdXNoKGVudGl0eSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgdGhpcy5lbnRpdHlSZW1vdmVBbGxDb21wb25lbnRzKGVudGl0eSwgaW1tZWRpYXRlbHkpO1xuICB9XG5cbiAgX3JlbGVhc2VFbnRpdHkoZW50aXR5LCBpbmRleCkge1xuICAgIHRoaXMuX2VudGl0aWVzLnNwbGljZShpbmRleCwgMSk7XG5cbiAgICAvLyBQcmV2ZW50IGFueSBhY2Nlc3MgYW5kIGZyZWVcbiAgICBlbnRpdHkuX3dvcmxkID0gbnVsbDtcbiAgICB0aGlzLl9lbnRpdHlQb29sLnJlbGVhc2UoZW50aXR5KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZW1vdmUgYWxsIGVudGl0aWVzIGZyb20gdGhpcyBtYW5hZ2VyXG4gICAqL1xuICByZW1vdmVBbGxFbnRpdGllcygpIHtcbiAgICBmb3IgKHZhciBpID0gdGhpcy5fZW50aXRpZXMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcbiAgICAgIHRoaXMucmVtb3ZlRW50aXR5KHRoaXMuX2VudGl0aWVzW2ldKTtcbiAgICB9XG4gIH1cblxuICBwcm9jZXNzRGVmZXJyZWRSZW1vdmFsKCkge1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5lbnRpdGllc1RvUmVtb3ZlLmxlbmd0aDsgaSsrKSB7XG4gICAgICBsZXQgZW50aXR5ID0gdGhpcy5lbnRpdGllc1RvUmVtb3ZlW2ldO1xuICAgICAgbGV0IGluZGV4ID0gdGhpcy5fZW50aXRpZXMuaW5kZXhPZihlbnRpdHkpO1xuICAgICAgdGhpcy5fcmVsZWFzZUVudGl0eShlbnRpdHksIGluZGV4KTtcbiAgICB9XG4gICAgdGhpcy5lbnRpdGllc1RvUmVtb3ZlLmxlbmd0aCA9IDA7XG5cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuZW50aXRpZXNXaXRoQ29tcG9uZW50c1RvUmVtb3ZlLmxlbmd0aDsgaSsrKSB7XG4gICAgICBsZXQgZW50aXR5ID0gdGhpcy5lbnRpdGllc1dpdGhDb21wb25lbnRzVG9SZW1vdmVbaV07XG4gICAgICB3aGlsZSAoZW50aXR5Ll9Db21wb25lbnRUeXBlc1RvUmVtb3ZlLmxlbmd0aCA+IDApIHtcbiAgICAgICAgbGV0IENvbXBvbmVudCA9IGVudGl0eS5fQ29tcG9uZW50VHlwZXNUb1JlbW92ZS5wb3AoKTtcblxuICAgICAgICB2YXIgcHJvcE5hbWUgPSBjb21wb25lbnRQcm9wZXJ0eU5hbWUoQ29tcG9uZW50KTtcbiAgICAgICAgdmFyIGNvbXBvbmVudE5hbWUgPSBnZXROYW1lKENvbXBvbmVudCk7XG4gICAgICAgIHZhciBjb21wb25lbnQgPSBlbnRpdHkuX2NvbXBvbmVudHNUb1JlbW92ZVtjb21wb25lbnROYW1lXTtcbiAgICAgICAgZGVsZXRlIGVudGl0eS5fY29tcG9uZW50c1RvUmVtb3ZlW2NvbXBvbmVudE5hbWVdO1xuICAgICAgICB0aGlzLmNvbXBvbmVudHNNYW5hZ2VyLl9jb21wb25lbnRQb29sW3Byb3BOYW1lXS5yZWxlYXNlKGNvbXBvbmVudCk7XG4gICAgICAgIC8vdGhpcy53b3JsZC5jb21wb25lbnRzTWFuYWdlci5jb21wb25lbnRSZW1vdmVkRnJvbUVudGl0eShDb21wb25lbnQpO1xuXG4gICAgICAgIC8vdGhpcy5fZW50aXR5UmVtb3ZlQ29tcG9uZW50U3luYyhlbnRpdHksIENvbXBvbmVudCwgaW5kZXgpO1xuICAgICAgfVxuICAgIH1cblxuICAgIHRoaXMuZW50aXRpZXNXaXRoQ29tcG9uZW50c1RvUmVtb3ZlLmxlbmd0aCA9IDA7XG4gIH1cblxuICAvKipcbiAgICogR2V0IGEgcXVlcnkgYmFzZWQgb24gYSBsaXN0IG9mIGNvbXBvbmVudHNcbiAgICogQHBhcmFtIHtBcnJheShDb21wb25lbnQpfSBDb21wb25lbnRzIExpc3Qgb2YgY29tcG9uZW50cyB0aGF0IHdpbGwgZm9ybSB0aGUgcXVlcnlcbiAgICovXG4gIHF1ZXJ5Q29tcG9uZW50cyhDb21wb25lbnRzKSB7XG4gICAgcmV0dXJuIHRoaXMuX3F1ZXJ5TWFuYWdlci5nZXRRdWVyeShDb21wb25lbnRzKTtcbiAgfVxuXG4gIC8vIEVYVFJBU1xuXG4gIC8qKlxuICAgKiBSZXR1cm4gbnVtYmVyIG9mIGVudGl0aWVzXG4gICAqL1xuICBjb3VudCgpIHtcbiAgICByZXR1cm4gdGhpcy5fZW50aXRpZXMubGVuZ3RoO1xuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybiBzb21lIHN0YXRzXG4gICAqL1xuICBzdGF0cygpIHtcbiAgICB2YXIgc3RhdHMgPSB7XG4gICAgICBudW1FbnRpdGllczogdGhpcy5fZW50aXRpZXMubGVuZ3RoLFxuICAgICAgbnVtUXVlcmllczogT2JqZWN0LmtleXModGhpcy5fcXVlcnlNYW5hZ2VyLl9xdWVyaWVzKS5sZW5ndGgsXG4gICAgICBxdWVyaWVzOiB0aGlzLl9xdWVyeU1hbmFnZXIuc3RhdHMoKSxcbiAgICAgIG51bUNvbXBvbmVudFBvb2w6IE9iamVjdC5rZXlzKHRoaXMuY29tcG9uZW50c01hbmFnZXIuX2NvbXBvbmVudFBvb2wpXG4gICAgICAgIC5sZW5ndGgsXG4gICAgICBjb21wb25lbnRQb29sOiB7fSxcbiAgICAgIGV2ZW50RGlzcGF0Y2hlcjogdGhpcy5ldmVudERpc3BhdGNoZXIuc3RhdHNcbiAgICB9O1xuXG4gICAgZm9yICh2YXIgY25hbWUgaW4gdGhpcy5jb21wb25lbnRzTWFuYWdlci5fY29tcG9uZW50UG9vbCkge1xuICAgICAgdmFyIHBvb2wgPSB0aGlzLmNvbXBvbmVudHNNYW5hZ2VyLl9jb21wb25lbnRQb29sW2NuYW1lXTtcbiAgICAgIHN0YXRzLmNvbXBvbmVudFBvb2xbY25hbWVdID0ge1xuICAgICAgICB1c2VkOiBwb29sLnRvdGFsVXNlZCgpLFxuICAgICAgICBzaXplOiBwb29sLmNvdW50XG4gICAgICB9O1xuICAgIH1cblxuICAgIHJldHVybiBzdGF0cztcbiAgfVxufVxuXG5jb25zdCBFTlRJVFlfQ1JFQVRFRCA9IFwiRW50aXR5TWFuYWdlciNFTlRJVFlfQ1JFQVRFXCI7XG5jb25zdCBFTlRJVFlfUkVNT1ZFRCA9IFwiRW50aXR5TWFuYWdlciNFTlRJVFlfUkVNT1ZFRFwiO1xuY29uc3QgQ09NUE9ORU5UX0FEREVEID0gXCJFbnRpdHlNYW5hZ2VyI0NPTVBPTkVOVF9BRERFRFwiO1xuY29uc3QgQ09NUE9ORU5UX1JFTU9WRSA9IFwiRW50aXR5TWFuYWdlciNDT01QT05FTlRfUkVNT1ZFXCI7XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBEdW1teU9iamVjdFBvb2wge1xuICBjb25zdHJ1Y3RvcihUKSB7XG4gICAgdGhpcy5jb3VudCA9IDA7XG4gICAgdGhpcy51c2VkID0gMDtcbiAgICB0aGlzLlQgPSBUO1xuICB9XG5cbiAgYXF1aXJlKCkge1xuICAgIHRoaXMudXNlZCsrO1xuICAgIHRoaXMuY291bnQrKztcbiAgICByZXR1cm4gbmV3IHRoaXMuVCgpO1xuICB9XG5cbiAgcmVsZWFzZSgpIHtcbiAgICB0aGlzLnVzZWQtLTtcbiAgfVxuXG4gIHRvdGFsU2l6ZSgpIHtcbiAgICByZXR1cm4gdGhpcy5jb3VudDtcbiAgfVxuXG4gIHRvdGFsRnJlZSgpIHtcbiAgICByZXR1cm4gSW5maW5pdHk7XG4gIH1cblxuICB0b3RhbFVzZWQoKSB7XG4gICAgcmV0dXJuIHRoaXMudXNlZDtcbiAgfVxufVxuIiwiaW1wb3J0IE9iamVjdFBvb2wgZnJvbSBcIi4vT2JqZWN0UG9vbC5qc1wiO1xuaW1wb3J0IER1bW15T2JqZWN0UG9vbCBmcm9tIFwiLi9EdW1teU9iamVjdFBvb2wuanNcIjtcbmltcG9ydCB7IGNvbXBvbmVudFByb3BlcnR5TmFtZSB9IGZyb20gXCIuL1V0aWxzLmpzXCI7XG5cbmV4cG9ydCBjbGFzcyBDb21wb25lbnRNYW5hZ2VyIHtcbiAgY29uc3RydWN0b3IoKSB7XG4gICAgdGhpcy5Db21wb25lbnRzID0ge307XG4gICAgdGhpcy5fY29tcG9uZW50UG9vbCA9IHt9O1xuICAgIHRoaXMubnVtQ29tcG9uZW50cyA9IHt9O1xuICB9XG5cbiAgcmVnaXN0ZXJDb21wb25lbnQoQ29tcG9uZW50KSB7XG4gICAgdGhpcy5Db21wb25lbnRzW0NvbXBvbmVudC5uYW1lXSA9IENvbXBvbmVudDtcbiAgICB0aGlzLm51bUNvbXBvbmVudHNbQ29tcG9uZW50Lm5hbWVdID0gMDtcbiAgfVxuXG4gIGNvbXBvbmVudEFkZGVkVG9FbnRpdHkoQ29tcG9uZW50KSB7XG4gICAgaWYgKCF0aGlzLm51bUNvbXBvbmVudHNbQ29tcG9uZW50Lm5hbWVdKSB7XG4gICAgICB0aGlzLm51bUNvbXBvbmVudHNbQ29tcG9uZW50Lm5hbWVdID0gMTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5udW1Db21wb25lbnRzW0NvbXBvbmVudC5uYW1lXSsrO1xuICAgIH1cbiAgfVxuXG4gIGNvbXBvbmVudFJlbW92ZWRGcm9tRW50aXR5KENvbXBvbmVudCkge1xuICAgIHRoaXMubnVtQ29tcG9uZW50c1tDb21wb25lbnQubmFtZV0tLTtcbiAgfVxuXG4gIGdldENvbXBvbmVudHNQb29sKENvbXBvbmVudCkge1xuICAgIHZhciBjb21wb25lbnROYW1lID0gY29tcG9uZW50UHJvcGVydHlOYW1lKENvbXBvbmVudCk7XG5cbiAgICBpZiAoIXRoaXMuX2NvbXBvbmVudFBvb2xbY29tcG9uZW50TmFtZV0pIHtcbiAgICAgIGlmIChDb21wb25lbnQucHJvdG90eXBlLnJlc2V0KSB7XG4gICAgICAgIHRoaXMuX2NvbXBvbmVudFBvb2xbY29tcG9uZW50TmFtZV0gPSBuZXcgT2JqZWN0UG9vbChDb21wb25lbnQpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29uc29sZS53YXJuKFxuICAgICAgICAgIGBDb21wb25lbnQgJyR7Q29tcG9uZW50Lm5hbWV9JyB3b24ndCBiZW5lZml0IGZyb20gcG9vbGluZyBiZWNhdXNlICdyZXNldCcgbWV0aG9kIHdhcyBub3QgaW1wbGVtZW5ldGVkLmBcbiAgICAgICAgKTtcbiAgICAgICAgdGhpcy5fY29tcG9uZW50UG9vbFtjb21wb25lbnROYW1lXSA9IG5ldyBEdW1teU9iamVjdFBvb2woQ29tcG9uZW50KTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcy5fY29tcG9uZW50UG9vbFtjb21wb25lbnROYW1lXTtcbiAgfVxufVxuIiwiZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVR5cGUodHlwZURlZmluaXRpb24pIHtcbiAgdmFyIG1hbmRhdG9yeUZ1bmN0aW9ucyA9IFtcbiAgICBcImNyZWF0ZVwiLFxuICAgIFwicmVzZXRcIixcbiAgICBcImNsZWFyXCJcbiAgICAvKlwiY29weVwiKi9cbiAgXTtcblxuICB2YXIgdW5kZWZpbmVkRnVuY3Rpb25zID0gbWFuZGF0b3J5RnVuY3Rpb25zLmZpbHRlcihmID0+IHtcbiAgICByZXR1cm4gIXR5cGVEZWZpbml0aW9uW2ZdO1xuICB9KTtcblxuICBpZiAodW5kZWZpbmVkRnVuY3Rpb25zLmxlbmd0aCA+IDApIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICBgY3JlYXRlVHlwZSBleHBlY3QgdHlwZSBkZWZpbml0aW9uIHRvIGltcGxlbWVudHMgdGhlIGZvbGxvd2luZyBmdW5jdGlvbnM6ICR7dW5kZWZpbmVkRnVuY3Rpb25zLmpvaW4oXG4gICAgICAgIFwiLCBcIlxuICAgICAgKX1gXG4gICAgKTtcbiAgfVxuXG4gIHR5cGVEZWZpbml0aW9uLmlzVHlwZSA9IHRydWU7XG4gIHJldHVybiB0eXBlRGVmaW5pdGlvbjtcbn1cbiIsImltcG9ydCB7IGNyZWF0ZVR5cGUgfSBmcm9tIFwiLi9DcmVhdGVUeXBlXCI7XG5cbi8qKlxuICogU3RhbmRhcmQgdHlwZXNcbiAqL1xudmFyIFR5cGVzID0ge307XG5cblR5cGVzLk51bWJlciA9IGNyZWF0ZVR5cGUoe1xuICBiYXNlVHlwZTogTnVtYmVyLFxuICBpc1NpbXBsZVR5cGU6IHRydWUsXG4gIGNyZWF0ZTogZGVmYXVsdFZhbHVlID0+IHtcbiAgICByZXR1cm4gdHlwZW9mIGRlZmF1bHRWYWx1ZSAhPT0gXCJ1bmRlZmluZWRcIiA/IGRlZmF1bHRWYWx1ZSA6IDA7XG4gIH0sXG4gIHJlc2V0OiAoc3JjLCBrZXksIGRlZmF1bHRWYWx1ZSkgPT4ge1xuICAgIGlmICh0eXBlb2YgZGVmYXVsdFZhbHVlICE9PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICBzcmNba2V5XSA9IGRlZmF1bHRWYWx1ZTtcbiAgICB9IGVsc2Uge1xuICAgICAgc3JjW2tleV0gPSAwO1xuICAgIH1cbiAgfSxcbiAgY2xlYXI6IChzcmMsIGtleSkgPT4ge1xuICAgIHNyY1trZXldID0gMDtcbiAgfVxufSk7XG5cblR5cGVzLkJvb2xlYW4gPSBjcmVhdGVUeXBlKHtcbiAgYmFzZVR5cGU6IEJvb2xlYW4sXG4gIGlzU2ltcGxlVHlwZTogdHJ1ZSxcbiAgY3JlYXRlOiBkZWZhdWx0VmFsdWUgPT4ge1xuICAgIHJldHVybiB0eXBlb2YgZGVmYXVsdFZhbHVlICE9PSBcInVuZGVmaW5lZFwiID8gZGVmYXVsdFZhbHVlIDogZmFsc2U7XG4gIH0sXG4gIHJlc2V0OiAoc3JjLCBrZXksIGRlZmF1bHRWYWx1ZSkgPT4ge1xuICAgIGlmICh0eXBlb2YgZGVmYXVsdFZhbHVlICE9PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICBzcmNba2V5XSA9IGRlZmF1bHRWYWx1ZTtcbiAgICB9IGVsc2Uge1xuICAgICAgc3JjW2tleV0gPSBmYWxzZTtcbiAgICB9XG4gIH0sXG4gIGNsZWFyOiAoc3JjLCBrZXkpID0+IHtcbiAgICBzcmNba2V5XSA9IGZhbHNlO1xuICB9XG59KTtcblxuVHlwZXMuU3RyaW5nID0gY3JlYXRlVHlwZSh7XG4gIGJhc2VUeXBlOiBTdHJpbmcsXG4gIGlzU2ltcGxlVHlwZTogdHJ1ZSxcbiAgY3JlYXRlOiBkZWZhdWx0VmFsdWUgPT4ge1xuICAgIHJldHVybiB0eXBlb2YgZGVmYXVsdFZhbHVlICE9PSBcInVuZGVmaW5lZFwiID8gZGVmYXVsdFZhbHVlIDogXCJcIjtcbiAgfSxcbiAgcmVzZXQ6IChzcmMsIGtleSwgZGVmYXVsdFZhbHVlKSA9PiB7XG4gICAgaWYgKHR5cGVvZiBkZWZhdWx0VmFsdWUgIT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgIHNyY1trZXldID0gZGVmYXVsdFZhbHVlO1xuICAgIH0gZWxzZSB7XG4gICAgICBzcmNba2V5XSA9IFwiXCI7XG4gICAgfVxuICB9LFxuICBjbGVhcjogKHNyYywga2V5KSA9PiB7XG4gICAgc3JjW2tleV0gPSBcIlwiO1xuICB9XG59KTtcblxuVHlwZXMuQXJyYXkgPSBjcmVhdGVUeXBlKHtcbiAgYmFzZVR5cGU6IEFycmF5LFxuICBjcmVhdGU6IGRlZmF1bHRWYWx1ZSA9PiB7XG4gICAgaWYgKHR5cGVvZiBkZWZhdWx0VmFsdWUgIT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgIHJldHVybiBkZWZhdWx0VmFsdWUuc2xpY2UoKTtcbiAgICB9XG5cbiAgICByZXR1cm4gW107XG4gIH0sXG4gIHJlc2V0OiAoc3JjLCBrZXksIGRlZmF1bHRWYWx1ZSkgPT4ge1xuICAgIGlmICh0eXBlb2YgZGVmYXVsdFZhbHVlICE9PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICBzcmNba2V5XSA9IGRlZmF1bHRWYWx1ZS5zbGljZSgpO1xuICAgIH0gZWxzZSB7XG4gICAgICBzcmNba2V5XS5sZW5ndGggPSAwO1xuICAgIH1cbiAgfSxcbiAgY2xlYXI6IChzcmMsIGtleSkgPT4ge1xuICAgIHNyY1trZXldLmxlbmd0aCA9IDA7XG4gIH0sXG4gIGNvcHk6IChzcmMsIGRzdCwga2V5KSA9PiB7XG4gICAgc3JjW2tleV0gPSBkc3Rba2V5XS5zbGljZSgpO1xuICB9XG59KTtcblxuZXhwb3J0IHsgVHlwZXMgfTtcbiIsImltcG9ydCB7IFR5cGVzIH0gZnJvbSBcIi4vU3RhbmRhcmRUeXBlc1wiO1xuXG52YXIgc3RhbmRhcmRUeXBlcyA9IHtcbiAgbnVtYmVyOiBUeXBlcy5OdW1iZXIsXG4gIGJvb2xlYW46IFR5cGVzLkJvb2xlYW4sXG4gIHN0cmluZzogVHlwZXMuU3RyaW5nXG59O1xuXG4vKipcbiAqIFRyeSB0byBpbmZlciB0aGUgdHlwZSBvZiB0aGUgdmFsdWVcbiAqIEBwYXJhbSB7Kn0gdmFsdWVcbiAqIEByZXR1cm4ge1N0cmluZ30gVHlwZSBvZiB0aGUgYXR0cmlidXRlXG4gKiBAcHJpdmF0ZVxuICovXG5leHBvcnQgZnVuY3Rpb24gaW5mZXJUeXBlKHZhbHVlKSB7XG4gIGlmIChBcnJheS5pc0FycmF5KHZhbHVlKSkge1xuICAgIHJldHVybiBUeXBlcy5BcnJheTtcbiAgfVxuXG4gIGlmIChzdGFuZGFyZFR5cGVzW3R5cGVvZiB2YWx1ZV0pIHtcbiAgICByZXR1cm4gc3RhbmRhcmRUeXBlc1t0eXBlb2YgdmFsdWVdO1xuICB9IGVsc2Uge1xuICAgIHJldHVybiBudWxsO1xuICB9XG59XG4iLCJleHBvcnQgY2xhc3MgQ29tcG9uZW50IHt9XG4iLCJpbXBvcnQgUXVlcnkgZnJvbSBcIi4vUXVlcnkuanNcIjtcblxuZXhwb3J0IGNsYXNzIFN5c3RlbSB7XG4gIGNhbkV4ZWN1dGUoKSB7XG4gICAgaWYgKHRoaXMuX21hbmRhdG9yeVF1ZXJpZXMubGVuZ3RoID09PSAwKSByZXR1cm4gdHJ1ZTtcblxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5fbWFuZGF0b3J5UXVlcmllcy5sZW5ndGg7IGkrKykge1xuICAgICAgdmFyIHF1ZXJ5ID0gdGhpcy5fbWFuZGF0b3J5UXVlcmllc1tpXTtcbiAgICAgIGlmIChxdWVyeS5lbnRpdGllcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiB0cnVlO1xuICB9XG5cbiAgY29uc3RydWN0b3Iod29ybGQsIGF0dHJpYnV0ZXMpIHtcbiAgICB0aGlzLndvcmxkID0gd29ybGQ7XG4gICAgdGhpcy5lbmFibGVkID0gdHJ1ZTtcblxuICAgIC8vIEB0b2RvIEJldHRlciBuYW1pbmcgOilcbiAgICB0aGlzLl9xdWVyaWVzID0ge307XG4gICAgdGhpcy5xdWVyaWVzID0ge307XG5cbiAgICB0aGlzLnByaW9yaXR5ID0gMDtcblxuICAgIC8vIFVzZWQgZm9yIHN0YXRzXG4gICAgdGhpcy5leGVjdXRlVGltZSA9IDA7XG5cbiAgICBpZiAoYXR0cmlidXRlcyAmJiBhdHRyaWJ1dGVzLnByaW9yaXR5KSB7XG4gICAgICB0aGlzLnByaW9yaXR5ID0gYXR0cmlidXRlcy5wcmlvcml0eTtcbiAgICB9XG5cbiAgICB0aGlzLl9tYW5kYXRvcnlRdWVyaWVzID0gW107XG5cbiAgICB0aGlzLmluaXRpYWxpemVkID0gdHJ1ZTtcblxuICAgIGlmICh0aGlzLmNvbnN0cnVjdG9yLnF1ZXJpZXMpIHtcbiAgICAgIGZvciAodmFyIHF1ZXJ5TmFtZSBpbiB0aGlzLmNvbnN0cnVjdG9yLnF1ZXJpZXMpIHtcbiAgICAgICAgdmFyIHF1ZXJ5Q29uZmlnID0gdGhpcy5jb25zdHJ1Y3Rvci5xdWVyaWVzW3F1ZXJ5TmFtZV07XG4gICAgICAgIHZhciBDb21wb25lbnRzID0gcXVlcnlDb25maWcuY29tcG9uZW50cztcbiAgICAgICAgaWYgKCFDb21wb25lbnRzIHx8IENvbXBvbmVudHMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiJ2NvbXBvbmVudHMnIGF0dHJpYnV0ZSBjYW4ndCBiZSBlbXB0eSBpbiBhIHF1ZXJ5XCIpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBxdWVyeSA9IHRoaXMud29ybGQuZW50aXR5TWFuYWdlci5xdWVyeUNvbXBvbmVudHMoQ29tcG9uZW50cyk7XG4gICAgICAgIHRoaXMuX3F1ZXJpZXNbcXVlcnlOYW1lXSA9IHF1ZXJ5O1xuICAgICAgICBpZiAocXVlcnlDb25maWcubWFuZGF0b3J5ID09PSB0cnVlKSB7XG4gICAgICAgICAgdGhpcy5fbWFuZGF0b3J5UXVlcmllcy5wdXNoKHF1ZXJ5KTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnF1ZXJpZXNbcXVlcnlOYW1lXSA9IHtcbiAgICAgICAgICByZXN1bHRzOiBxdWVyeS5lbnRpdGllc1xuICAgICAgICB9O1xuXG4gICAgICAgIC8vIFJlYWN0aXZlIGNvbmZpZ3VyYXRpb24gYWRkZWQvcmVtb3ZlZC9jaGFuZ2VkXG4gICAgICAgIHZhciB2YWxpZEV2ZW50cyA9IFtcImFkZGVkXCIsIFwicmVtb3ZlZFwiLCBcImNoYW5nZWRcIl07XG5cbiAgICAgICAgY29uc3QgZXZlbnRNYXBwaW5nID0ge1xuICAgICAgICAgIGFkZGVkOiBRdWVyeS5wcm90b3R5cGUuRU5USVRZX0FEREVELFxuICAgICAgICAgIHJlbW92ZWQ6IFF1ZXJ5LnByb3RvdHlwZS5FTlRJVFlfUkVNT1ZFRCxcbiAgICAgICAgICBjaGFuZ2VkOiBRdWVyeS5wcm90b3R5cGUuQ09NUE9ORU5UX0NIQU5HRUQgLy8gUXVlcnkucHJvdG90eXBlLkVOVElUWV9DSEFOR0VEXG4gICAgICAgIH07XG5cbiAgICAgICAgaWYgKHF1ZXJ5Q29uZmlnLmxpc3Rlbikge1xuICAgICAgICAgIHZhbGlkRXZlbnRzLmZvckVhY2goZXZlbnROYW1lID0+IHtcbiAgICAgICAgICAgIC8vIElzIHRoZSBldmVudCBlbmFibGVkIG9uIHRoaXMgc3lzdGVtJ3MgcXVlcnk/XG4gICAgICAgICAgICBpZiAocXVlcnlDb25maWcubGlzdGVuW2V2ZW50TmFtZV0pIHtcbiAgICAgICAgICAgICAgbGV0IGV2ZW50ID0gcXVlcnlDb25maWcubGlzdGVuW2V2ZW50TmFtZV07XG5cbiAgICAgICAgICAgICAgaWYgKGV2ZW50TmFtZSA9PT0gXCJjaGFuZ2VkXCIpIHtcbiAgICAgICAgICAgICAgICBxdWVyeS5yZWFjdGl2ZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgaWYgKGV2ZW50ID09PSB0cnVlKSB7XG4gICAgICAgICAgICAgICAgICAvLyBBbnkgY2hhbmdlIG9uIHRoZSBlbnRpdHkgZnJvbSB0aGUgY29tcG9uZW50cyBpbiB0aGUgcXVlcnlcbiAgICAgICAgICAgICAgICAgIGxldCBldmVudExpc3QgPSAodGhpcy5xdWVyaWVzW3F1ZXJ5TmFtZV1bZXZlbnROYW1lXSA9IFtdKTtcbiAgICAgICAgICAgICAgICAgIHF1ZXJ5LmV2ZW50RGlzcGF0Y2hlci5hZGRFdmVudExpc3RlbmVyKFxuICAgICAgICAgICAgICAgICAgICBRdWVyeS5wcm90b3R5cGUuQ09NUE9ORU5UX0NIQU5HRUQsXG4gICAgICAgICAgICAgICAgICAgIGVudGl0eSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgLy8gQXZvaWQgZHVwbGljYXRlc1xuICAgICAgICAgICAgICAgICAgICAgIGlmIChldmVudExpc3QuaW5kZXhPZihlbnRpdHkpID09PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnRMaXN0LnB1c2goZW50aXR5KTtcbiAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChBcnJheS5pc0FycmF5KGV2ZW50KSkge1xuICAgICAgICAgICAgICAgICAgbGV0IGV2ZW50TGlzdCA9ICh0aGlzLnF1ZXJpZXNbcXVlcnlOYW1lXVtldmVudE5hbWVdID0gW10pO1xuICAgICAgICAgICAgICAgICAgcXVlcnkuZXZlbnREaXNwYXRjaGVyLmFkZEV2ZW50TGlzdGVuZXIoXG4gICAgICAgICAgICAgICAgICAgIFF1ZXJ5LnByb3RvdHlwZS5DT01QT05FTlRfQ0hBTkdFRCxcbiAgICAgICAgICAgICAgICAgICAgKGVudGl0eSwgY2hhbmdlZENvbXBvbmVudCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgIC8vIEF2b2lkIGR1cGxpY2F0ZXNcbiAgICAgICAgICAgICAgICAgICAgICBpZiAoXG4gICAgICAgICAgICAgICAgICAgICAgICBldmVudC5pbmRleE9mKGNoYW5nZWRDb21wb25lbnQuY29uc3RydWN0b3IpICE9PSAtMSAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnRMaXN0LmluZGV4T2YoZW50aXR5KSA9PT0gLTFcbiAgICAgICAgICAgICAgICAgICAgICApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50TGlzdC5wdXNoKGVudGl0eSk7XG4gICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAvKlxuICAgICAgICAgICAgICAgICAgLy8gQ2hlY2tpbmcganVzdCBzcGVjaWZpYyBjb21wb25lbnRzXG4gICAgICAgICAgICAgICAgICBsZXQgY2hhbmdlZExpc3QgPSAodGhpcy5xdWVyaWVzW3F1ZXJ5TmFtZV1bZXZlbnROYW1lXSA9IHt9KTtcbiAgICAgICAgICAgICAgICAgIGV2ZW50LmZvckVhY2goY29tcG9uZW50ID0+IHtcbiAgICAgICAgICAgICAgICAgICAgbGV0IGV2ZW50TGlzdCA9IChjaGFuZ2VkTGlzdFtcbiAgICAgICAgICAgICAgICAgICAgICBjb21wb25lbnRQcm9wZXJ0eU5hbWUoY29tcG9uZW50KVxuICAgICAgICAgICAgICAgICAgICBdID0gW10pO1xuICAgICAgICAgICAgICAgICAgICBxdWVyeS5ldmVudERpc3BhdGNoZXIuYWRkRXZlbnRMaXN0ZW5lcihcbiAgICAgICAgICAgICAgICAgICAgICBRdWVyeS5wcm90b3R5cGUuQ09NUE9ORU5UX0NIQU5HRUQsXG4gICAgICAgICAgICAgICAgICAgICAgKGVudGl0eSwgY2hhbmdlZENvbXBvbmVudCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKFxuICAgICAgICAgICAgICAgICAgICAgICAgICBjaGFuZ2VkQ29tcG9uZW50LmNvbnN0cnVjdG9yID09PSBjb21wb25lbnQgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnRMaXN0LmluZGV4T2YoZW50aXR5KSA9PT0gLTFcbiAgICAgICAgICAgICAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICBldmVudExpc3QucHVzaChlbnRpdHkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgbGV0IGV2ZW50TGlzdCA9ICh0aGlzLnF1ZXJpZXNbcXVlcnlOYW1lXVtldmVudE5hbWVdID0gW10pO1xuXG4gICAgICAgICAgICAgICAgcXVlcnkuZXZlbnREaXNwYXRjaGVyLmFkZEV2ZW50TGlzdGVuZXIoXG4gICAgICAgICAgICAgICAgICBldmVudE1hcHBpbmdbZXZlbnROYW1lXSxcbiAgICAgICAgICAgICAgICAgIGVudGl0eSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIC8vIEBmaXhtZSBvdmVyaGVhZD9cbiAgICAgICAgICAgICAgICAgICAgaWYgKGV2ZW50TGlzdC5pbmRleE9mKGVudGl0eSkgPT09IC0xKVxuICAgICAgICAgICAgICAgICAgICAgIGV2ZW50TGlzdC5wdXNoKGVudGl0eSk7XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgc3RvcCgpIHtcbiAgICB0aGlzLmVuYWJsZWQgPSBmYWxzZTtcbiAgfVxuXG4gIHBsYXkoKSB7XG4gICAgdGhpcy5lbmFibGVkID0gdHJ1ZTtcbiAgfVxuXG4gIC8vIEBxdWVzdGlvbiByZW5hbWUgdG8gY2xlYXIgcXVldWVzP1xuICBjbGVhckV2ZW50cygpIHtcbiAgICBmb3IgKGxldCBxdWVyeU5hbWUgaW4gdGhpcy5xdWVyaWVzKSB7XG4gICAgICB2YXIgcXVlcnkgPSB0aGlzLnF1ZXJpZXNbcXVlcnlOYW1lXTtcbiAgICAgIGlmIChxdWVyeS5hZGRlZCkgcXVlcnkuYWRkZWQubGVuZ3RoID0gMDtcbiAgICAgIGlmIChxdWVyeS5yZW1vdmVkKSBxdWVyeS5yZW1vdmVkLmxlbmd0aCA9IDA7XG4gICAgICBpZiAocXVlcnkuY2hhbmdlZCkge1xuICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShxdWVyeS5jaGFuZ2VkKSkge1xuICAgICAgICAgIHF1ZXJ5LmNoYW5nZWQubGVuZ3RoID0gMDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBmb3IgKGxldCBuYW1lIGluIHF1ZXJ5LmNoYW5nZWQpIHtcbiAgICAgICAgICAgIHF1ZXJ5LmNoYW5nZWRbbmFtZV0ubGVuZ3RoID0gMDtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICB0b0pTT04oKSB7XG4gICAgdmFyIGpzb24gPSB7XG4gICAgICBuYW1lOiB0aGlzLmNvbnN0cnVjdG9yLm5hbWUsXG4gICAgICBlbmFibGVkOiB0aGlzLmVuYWJsZWQsXG4gICAgICBleGVjdXRlVGltZTogdGhpcy5leGVjdXRlVGltZSxcbiAgICAgIHByaW9yaXR5OiB0aGlzLnByaW9yaXR5LFxuICAgICAgcXVlcmllczoge31cbiAgICB9O1xuXG4gICAgLypcbiAgICBpZiAodGhpcy5jb25maWcpIHtcbiAgICAgIHZhciBxdWVyaWVzID0gdGhpcy5xdWVyaWVzO1xuICAgICAgZm9yIChsZXQgcXVlcnlOYW1lIGluIHF1ZXJpZXMpIHtcbiAgICAgICAgbGV0IHF1ZXJ5ID0gcXVlcmllc1txdWVyeU5hbWVdO1xuICAgICAgICBqc29uLnF1ZXJpZXNbcXVlcnlOYW1lXSA9IHtcbiAgICAgICAgICBrZXk6IHRoaXMuX3F1ZXJpZXNbcXVlcnlOYW1lXS5rZXlcbiAgICAgICAgfTtcbiAgICAgICAgaWYgKHF1ZXJ5LmV2ZW50cykge1xuICAgICAgICAgIGxldCBldmVudHMgPSAoanNvbi5xdWVyaWVzW3F1ZXJ5TmFtZV1bXCJldmVudHNcIl0gPSB7fSk7XG4gICAgICAgICAgZm9yIChsZXQgZXZlbnROYW1lIGluIHF1ZXJ5LmV2ZW50cykge1xuICAgICAgICAgICAgbGV0IGV2ZW50ID0gcXVlcnkuZXZlbnRzW2V2ZW50TmFtZV07XG4gICAgICAgICAgICBldmVudHNbZXZlbnROYW1lXSA9IHtcbiAgICAgICAgICAgICAgZXZlbnROYW1lOiBldmVudC5ldmVudCxcbiAgICAgICAgICAgICAgbnVtRW50aXRpZXM6IHRoaXMuZXZlbnRzW3F1ZXJ5TmFtZV1bZXZlbnROYW1lXS5sZW5ndGhcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBpZiAoZXZlbnQuY29tcG9uZW50cykge1xuICAgICAgICAgICAgICBldmVudHNbZXZlbnROYW1lXS5jb21wb25lbnRzID0gZXZlbnQuY29tcG9uZW50cy5tYXAoYyA9PiBjLm5hbWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiovXG5cbiAgICByZXR1cm4ganNvbjtcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gTm90KENvbXBvbmVudCkge1xuICByZXR1cm4ge1xuICAgIG9wZXJhdG9yOiBcIm5vdFwiLFxuICAgIENvbXBvbmVudDogQ29tcG9uZW50XG4gIH07XG59XG4iLCJleHBvcnQgY2xhc3MgVGFnQ29tcG9uZW50IHtcbiAgcmVzZXQoKSB7fVxufVxuIiwiaW1wb3J0IHsgU3lzdGVtTWFuYWdlciB9IGZyb20gXCIuL1N5c3RlbU1hbmFnZXIuanNcIjtcbmltcG9ydCB7IEVudGl0eU1hbmFnZXIgfSBmcm9tIFwiLi9FbnRpdHlNYW5hZ2VyLmpzXCI7XG5pbXBvcnQgeyBDb21wb25lbnRNYW5hZ2VyIH0gZnJvbSBcIi4vQ29tcG9uZW50TWFuYWdlci5qc1wiO1xuXG5leHBvcnQgY2xhc3MgV29ybGQge1xuICBjb25zdHJ1Y3RvcigpIHtcbiAgICB0aGlzLmNvbXBvbmVudHNNYW5hZ2VyID0gbmV3IENvbXBvbmVudE1hbmFnZXIodGhpcyk7XG4gICAgdGhpcy5lbnRpdHlNYW5hZ2VyID0gbmV3IEVudGl0eU1hbmFnZXIodGhpcyk7XG4gICAgdGhpcy5zeXN0ZW1NYW5hZ2VyID0gbmV3IFN5c3RlbU1hbmFnZXIodGhpcyk7XG5cbiAgICB0aGlzLmVuYWJsZWQgPSB0cnVlO1xuXG4gICAgdGhpcy5ldmVudFF1ZXVlcyA9IHt9O1xuXG4gICAgaWYgKHR5cGVvZiBDdXN0b21FdmVudCAhPT0gXCJ1bmRlZmluZWRcIikge1xuICAgICAgdmFyIGV2ZW50ID0gbmV3IEN1c3RvbUV2ZW50KFwiZWNzeS13b3JsZC1jcmVhdGVkXCIsIHsgZGV0YWlsOiB0aGlzIH0pO1xuICAgICAgd2luZG93LmRpc3BhdGNoRXZlbnQoZXZlbnQpO1xuICAgIH1cbiAgfVxuXG4gIHJlZ2lzdGVyQ29tcG9uZW50KENvbXBvbmVudCkge1xuICAgIHRoaXMuY29tcG9uZW50c01hbmFnZXIucmVnaXN0ZXJDb21wb25lbnQoQ29tcG9uZW50KTtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIHJlZ2lzdGVyU3lzdGVtKFN5c3RlbSwgYXR0cmlidXRlcykge1xuICAgIHRoaXMuc3lzdGVtTWFuYWdlci5yZWdpc3RlclN5c3RlbShTeXN0ZW0sIGF0dHJpYnV0ZXMpO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgZ2V0U3lzdGVtKFN5c3RlbUNsYXNzKSB7XG4gICAgcmV0dXJuIHRoaXMuc3lzdGVtTWFuYWdlci5nZXRTeXN0ZW0oU3lzdGVtQ2xhc3MpO1xuICB9XG5cbiAgZ2V0U3lzdGVtcygpIHtcbiAgICByZXR1cm4gdGhpcy5zeXN0ZW1NYW5hZ2VyLmdldFN5c3RlbXMoKTtcbiAgfVxuXG4gIGV4ZWN1dGUoZGVsdGEsIHRpbWUpIHtcbiAgICBpZiAodGhpcy5lbmFibGVkKSB7XG4gICAgICB0aGlzLnN5c3RlbU1hbmFnZXIuZXhlY3V0ZShkZWx0YSwgdGltZSk7XG4gICAgICB0aGlzLmVudGl0eU1hbmFnZXIucHJvY2Vzc0RlZmVycmVkUmVtb3ZhbCgpO1xuICAgIH1cbiAgfVxuXG4gIHN0b3AoKSB7XG4gICAgdGhpcy5lbmFibGVkID0gZmFsc2U7XG4gIH1cblxuICBwbGF5KCkge1xuICAgIHRoaXMuZW5hYmxlZCA9IHRydWU7XG4gIH1cblxuICBjcmVhdGVFbnRpdHkoKSB7XG4gICAgcmV0dXJuIHRoaXMuZW50aXR5TWFuYWdlci5jcmVhdGVFbnRpdHkoKTtcbiAgfVxuXG4gIHN0YXRzKCkge1xuICAgIHZhciBzdGF0cyA9IHtcbiAgICAgIGVudGl0aWVzOiB0aGlzLmVudGl0eU1hbmFnZXIuc3RhdHMoKSxcbiAgICAgIHN5c3RlbTogdGhpcy5zeXN0ZW1NYW5hZ2VyLnN0YXRzKClcbiAgICB9O1xuXG4gICAgY29uc29sZS5sb2coSlNPTi5zdHJpbmdpZnkoc3RhdHMsIG51bGwsIDIpKTtcbiAgfVxufVxuIiwiaW1wb3J0IHsgaW5mZXJUeXBlIH0gZnJvbSBcIi4vSW5mZXJUeXBlXCI7XG5cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVDb21wb25lbnRDbGFzcyhzY2hlbWEsIG5hbWUpIHtcbiAgLy92YXIgQ29tcG9uZW50ID0gbmV3IEZ1bmN0aW9uKGByZXR1cm4gZnVuY3Rpb24gJHtuYW1lfSgpIHt9YCkoKTtcbiAgZm9yIChsZXQga2V5IGluIHNjaGVtYSkge1xuICAgIGxldCB0eXBlID0gc2NoZW1hW2tleV0udHlwZTtcbiAgICBpZiAoIXR5cGUpIHtcbiAgICAgIHNjaGVtYVtrZXldLnR5cGUgPSBpbmZlclR5cGUoc2NoZW1hW2tleV0uZGVmYXVsdCk7XG4gICAgfVxuICB9XG5cbiAgdmFyIENvbXBvbmVudCA9IGZ1bmN0aW9uKCkge1xuICAgIGZvciAobGV0IGtleSBpbiBzY2hlbWEpIHtcbiAgICAgIHZhciBhdHRyID0gc2NoZW1hW2tleV07XG4gICAgICBsZXQgdHlwZSA9IGF0dHIudHlwZTtcbiAgICAgIGlmICh0eXBlICYmIHR5cGUuaXNUeXBlKSB7XG4gICAgICAgIHRoaXNba2V5XSA9IHR5cGUuY3JlYXRlKGF0dHIuZGVmYXVsdCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzW2tleV0gPSBhdHRyLmRlZmF1bHQ7XG4gICAgICB9XG4gICAgfVxuICB9O1xuXG4gIGlmICh0eXBlb2YgbmFtZSAhPT0gXCJ1bmRlZmluZWRcIikge1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShDb21wb25lbnQsIFwibmFtZVwiLCB7IHZhbHVlOiBuYW1lIH0pO1xuICB9XG5cbiAgQ29tcG9uZW50LnByb3RvdHlwZS5zY2hlbWEgPSBzY2hlbWE7XG5cbiAgdmFyIGtub3duVHlwZXMgPSB0cnVlO1xuICBmb3IgKGxldCBrZXkgaW4gc2NoZW1hKSB7XG4gICAgdmFyIGF0dHIgPSBzY2hlbWFba2V5XTtcbiAgICBpZiAoIWF0dHIudHlwZSkge1xuICAgICAgYXR0ci50eXBlID0gaW5mZXJUeXBlKGF0dHIuZGVmYXVsdCk7XG4gICAgfVxuXG4gICAgdmFyIHR5cGUgPSBhdHRyLnR5cGU7XG4gICAgaWYgKCF0eXBlKSB7XG4gICAgICBjb25zb2xlLndhcm4oYFVua25vd24gdHlwZSBkZWZpbml0aW9uIGZvciBhdHRyaWJ1dGUgJyR7a2V5fSdgKTtcbiAgICAgIGtub3duVHlwZXMgPSBmYWxzZTtcbiAgICB9XG4gIH1cblxuICBpZiAoIWtub3duVHlwZXMpIHtcbiAgICBjb25zb2xlLndhcm4oXG4gICAgICBgVGhpcyBjb21wb25lbnQgY2FuJ3QgdXNlIHBvb2xpbmcgYmVjYXVzZSBzb21lIGRhdGEgdHlwZXMgYXJlIG5vdCByZWdpc3RlcmVkLiBQbGVhc2UgcHJvdmlkZSBhIHR5cGUgY3JlYXRlZCB3aXRoICdjcmVhdGVUeXBlJ2BcbiAgICApO1xuXG4gICAgZm9yICh2YXIga2V5IGluIHNjaGVtYSkge1xuICAgICAgbGV0IGF0dHIgPSBzY2hlbWFba2V5XTtcbiAgICAgIENvbXBvbmVudC5wcm90b3R5cGVba2V5XSA9IGF0dHIuZGVmYXVsdDtcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgQ29tcG9uZW50LnByb3RvdHlwZS5jb3B5ID0gZnVuY3Rpb24oc3JjKSB7XG4gICAgICBmb3IgKGxldCBrZXkgaW4gc2NoZW1hKSB7XG4gICAgICAgIGlmIChzcmNba2V5XSkge1xuICAgICAgICAgIGxldCB0eXBlID0gc2NoZW1hW2tleV0udHlwZTtcbiAgICAgICAgICBpZiAodHlwZS5pc1NpbXBsZVR5cGUpIHtcbiAgICAgICAgICAgIHRoaXNba2V5XSA9IHNyY1trZXldO1xuICAgICAgICAgIH0gZWxzZSBpZiAodHlwZS5jb3B5KSB7XG4gICAgICAgICAgICB0eXBlLmNvcHkodGhpcywgc3JjLCBrZXkpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvLyBAdG9kbyBEZXRlY3QgdGhhdCBpdCdzIG5vdCBwb3NzaWJsZSB0byBjb3B5IGFsbCB0aGUgYXR0cmlidXRlc1xuICAgICAgICAgICAgLy8gYW5kIGp1c3QgYXZvaWQgY3JlYXRpbmcgdGhlIGNvcHkgZnVuY3Rpb25cbiAgICAgICAgICAgIGNvbnNvbGUud2FybihcbiAgICAgICAgICAgICAgYFVua25vd24gY29weSBmdW5jdGlvbiBmb3IgYXR0cmlidXRlICcke2tleX0nIGRhdGEgdHlwZWBcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfTtcblxuICAgIENvbXBvbmVudC5wcm90b3R5cGUucmVzZXQgPSBmdW5jdGlvbigpIHtcbiAgICAgIGZvciAobGV0IGtleSBpbiBzY2hlbWEpIHtcbiAgICAgICAgbGV0IGF0dHIgPSBzY2hlbWFba2V5XTtcbiAgICAgICAgbGV0IHR5cGUgPSBhdHRyLnR5cGU7XG4gICAgICAgIGlmICh0eXBlLnJlc2V0KSB0eXBlLnJlc2V0KHRoaXMsIGtleSwgYXR0ci5kZWZhdWx0KTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgQ29tcG9uZW50LnByb3RvdHlwZS5jbGVhciA9IGZ1bmN0aW9uKCkge1xuICAgICAgZm9yIChsZXQga2V5IGluIHNjaGVtYSkge1xuICAgICAgICBsZXQgdHlwZSA9IHNjaGVtYVtrZXldLnR5cGU7XG4gICAgICAgIGlmICh0eXBlLmNsZWFyKSB0eXBlLmNsZWFyKHRoaXMsIGtleSk7XG4gICAgICB9XG4gICAgfTtcblxuICAgIGZvciAobGV0IGtleSBpbiBzY2hlbWEpIHtcbiAgICAgIGxldCBhdHRyID0gc2NoZW1hW2tleV07XG4gICAgICBsZXQgdHlwZSA9IGF0dHIudHlwZTtcbiAgICAgIENvbXBvbmVudC5wcm90b3R5cGVba2V5XSA9IGF0dHIuZGVmYXVsdDtcblxuICAgICAgaWYgKHR5cGUucmVzZXQpIHtcbiAgICAgICAgdHlwZS5yZXNldChDb21wb25lbnQucHJvdG90eXBlLCBrZXksIGF0dHIuZGVmYXVsdCk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIENvbXBvbmVudDtcbn1cbiJdLCJuYW1lcyI6WyJTeXN0ZW1NYW5hZ2VyIiwiW29iamVjdCBPYmplY3RdIiwid29ybGQiLCJ0aGlzIiwiX3N5c3RlbXMiLCJfZXhlY3V0ZVN5c3RlbXMiLCJTeXN0ZW0iLCJhdHRyaWJ1dGVzIiwic3lzdGVtIiwiaW5pdCIsIm9yZGVyIiwibGVuZ3RoIiwicHVzaCIsImV4ZWN1dGUiLCJzb3J0U3lzdGVtcyIsInNvcnQiLCJhIiwiYiIsInByaW9yaXR5IiwiZmluZCIsInMiLCJpbmRleCIsImluZGV4T2YiLCJzcGxpY2UiLCJkZWx0YSIsInRpbWUiLCJmb3JFYWNoIiwiZW5hYmxlZCIsImluaXRpYWxpemVkIiwiY2FuRXhlY3V0ZSIsInN0YXJ0VGltZSIsInBlcmZvcm1hbmNlIiwibm93IiwiZXhlY3V0ZVRpbWUiLCJjbGVhckV2ZW50cyIsInN0YXRzIiwibnVtU3lzdGVtcyIsInN5c3RlbXMiLCJpIiwic3lzdGVtU3RhdHMiLCJjb25zdHJ1Y3RvciIsIm5hbWUiLCJxdWVyaWVzIiwiY3R4IiwiRXZlbnREaXNwYXRjaGVyIiwiX2xpc3RlbmVycyIsImZpcmVkIiwiaGFuZGxlZCIsImV2ZW50TmFtZSIsImxpc3RlbmVyIiwibGlzdGVuZXJzIiwidW5kZWZpbmVkIiwibGlzdGVuZXJBcnJheSIsImVudGl0eSIsImNvbXBvbmVudCIsImFycmF5Iiwic2xpY2UiLCJjYWxsIiwiZ2V0TmFtZSIsIkNvbXBvbmVudCIsImNvbXBvbmVudFByb3BlcnR5TmFtZSIsImNoYXJBdCIsInRvTG93ZXJDYXNlIiwicXVlcnlLZXkiLCJDb21wb25lbnRzIiwibmFtZXMiLCJuIiwiVCIsIm9wZXJhdG9yIiwibWFwIiwieCIsImpvaW4iLCJRdWVyeSIsIm1hbmFnZXIiLCJOb3RDb21wb25lbnRzIiwiRXJyb3IiLCJlbnRpdGllcyIsImV2ZW50RGlzcGF0Y2hlciIsInJlYWN0aXZlIiwia2V5IiwiX2VudGl0aWVzIiwibWF0Y2giLCJkaXNwYXRjaEV2ZW50IiwicHJvdG90eXBlIiwiRU5USVRZX0FEREVEIiwiRU5USVRZX1JFTU9WRUQiLCJoYXNBbGxDb21wb25lbnRzIiwiaGFzQW55Q29tcG9uZW50cyIsIm51bUNvbXBvbmVudHMiLCJudW1FbnRpdGllcyIsIkNPTVBPTkVOVF9DSEFOR0VEIiwibmV4dElkIiwiRW50aXR5IiwiX3dvcmxkIiwiaWQiLCJfQ29tcG9uZW50VHlwZXMiLCJfY29tcG9uZW50cyIsIl9jb21wb25lbnRzVG9SZW1vdmUiLCJfQ29tcG9uZW50VHlwZXNUb1JlbW92ZSIsImFsaXZlIiwicXVlcnkiLCJ2YWx1ZXMiLCJlbnRpdHlBZGRDb21wb25lbnQiLCJmb3JjZVJlbW92ZSIsImVudGl0eVJlbW92ZUNvbXBvbmVudCIsImhhc0NvbXBvbmVudCIsImVudGl0eVJlbW92ZUFsbENvbXBvbmVudHMiLCJyZW1vdmVFbnRpdHkiLCJPYmplY3RQb29sIiwiaW5pdGlhbFNpemUiLCJmcmVlTGlzdCIsImNvdW50IiwiZXh0cmFBcmdzIiwiYXJndW1lbnRzIiwiQXJyYXkiLCJzaGlmdCIsImNyZWF0ZUVsZW1lbnQiLCJleHBhbmQiLCJNYXRoIiwicm91bmQiLCJwb3AiLCJpdGVtIiwicmVzZXQiLCJRdWVyeU1hbmFnZXIiLCJfcXVlcmllcyIsInF1ZXJ5TmFtZSIsImFkZEVudGl0eSIsIlN5c3RlbVN0YXRlQ29tcG9uZW50IiwiRW50aXR5TWFuYWdlciIsImNvbXBvbmVudHNNYW5hZ2VyIiwiX3F1ZXJ5TWFuYWdlciIsIl9lbnRpdHlQb29sIiwiZW50aXRpZXNXaXRoQ29tcG9uZW50c1RvUmVtb3ZlIiwiZW50aXRpZXNUb1JlbW92ZSIsIm51bVN0YXRlQ29tcG9uZW50cyIsImFxdWlyZSIsIkVOVElUWV9DUkVBVEVEIiwiX19wcm90b19fIiwiZ2V0Q29tcG9uZW50c1Bvb2wiLCJjb3B5Iiwib25FbnRpdHlDb21wb25lbnRBZGRlZCIsImNvbXBvbmVudEFkZGVkVG9FbnRpdHkiLCJDT01QT05FTlRfQURERUQiLCJpbW1lZGlhdGVseSIsIkNPTVBPTkVOVF9SRU1PVkUiLCJfZW50aXR5UmVtb3ZlQ29tcG9uZW50U3luYyIsImNvbXBvbmVudE5hbWUiLCJvbkVudGl0eUNvbXBvbmVudFJlbW92ZWQiLCJyZW1vdmUiLCJwcm9wTmFtZSIsIl9jb21wb25lbnRQb29sIiwicmVsZWFzZSIsImNvbXBvbmVudFJlbW92ZWRGcm9tRW50aXR5IiwiaiIsIm9uRW50aXR5UmVtb3ZlZCIsIl9yZWxlYXNlRW50aXR5IiwiZ2V0UXVlcnkiLCJudW1RdWVyaWVzIiwiT2JqZWN0Iiwia2V5cyIsIm51bUNvbXBvbmVudFBvb2wiLCJjb21wb25lbnRQb29sIiwiY25hbWUiLCJwb29sIiwidXNlZCIsInRvdGFsVXNlZCIsInNpemUiLCJEdW1teU9iamVjdFBvb2wiLCJJbmZpbml0eSIsIkNvbXBvbmVudE1hbmFnZXIiLCJjb25zb2xlIiwid2FybiIsImNyZWF0ZVR5cGUiLCJ0eXBlRGVmaW5pdGlvbiIsInVuZGVmaW5lZEZ1bmN0aW9ucyIsImZpbHRlciIsImYiLCJpc1R5cGUiLCJUeXBlcyIsIk51bWJlciIsImJhc2VUeXBlIiwiaXNTaW1wbGVUeXBlIiwiY3JlYXRlIiwiZGVmYXVsdFZhbHVlIiwic3JjIiwiY2xlYXIiLCJCb29sZWFuIiwiU3RyaW5nIiwiZHN0Iiwic3RhbmRhcmRUeXBlcyIsIm51bWJlciIsImJvb2xlYW4iLCJzdHJpbmciLCJpbmZlclR5cGUiLCJ2YWx1ZSIsImlzQXJyYXkiLCJfbWFuZGF0b3J5UXVlcmllcyIsInF1ZXJ5Q29uZmlnIiwiY29tcG9uZW50cyIsImVudGl0eU1hbmFnZXIiLCJxdWVyeUNvbXBvbmVudHMiLCJtYW5kYXRvcnkiLCJyZXN1bHRzIiwiZXZlbnRNYXBwaW5nIiwiYWRkZWQiLCJyZW1vdmVkIiwiY2hhbmdlZCIsImxpc3RlbiIsImV2ZW50IiwiZXZlbnRMaXN0IiwiYWRkRXZlbnRMaXN0ZW5lciIsImNoYW5nZWRDb21wb25lbnQiLCJzeXN0ZW1NYW5hZ2VyIiwiZXZlbnRRdWV1ZXMiLCJDdXN0b21FdmVudCIsImRldGFpbCIsIndpbmRvdyIsInJlZ2lzdGVyQ29tcG9uZW50IiwicmVnaXN0ZXJTeXN0ZW0iLCJTeXN0ZW1DbGFzcyIsImdldFN5c3RlbSIsImdldFN5c3RlbXMiLCJwcm9jZXNzRGVmZXJyZWRSZW1vdmFsIiwiY3JlYXRlRW50aXR5IiwibG9nIiwiSlNPTiIsInN0cmluZ2lmeSIsInNjaGVtYSIsInR5cGUiLCJkZWZhdWx0IiwiYXR0ciIsImRlZmluZVByb3BlcnR5Iiwia25vd25UeXBlcyJdLCJtYXBwaW5ncyI6IjhRQUFPLE1BQU1BLEVBQ1hDLFlBQVlDLEdBQ1ZDLEtBQUtDLFNBQVcsR0FDaEJELEtBQUtFLGdCQUFrQixHQUN2QkYsS0FBS0QsTUFBUUEsRUFHZkQsZUFBZUssRUFBUUMsR0FDckIsSUFBSUMsRUFBUyxJQUFJRixFQUFPSCxLQUFLRCxNQUFPSyxHQU1wQyxPQUxJQyxFQUFPQyxNQUFNRCxFQUFPQyxPQUN4QkQsRUFBT0UsTUFBUVAsS0FBS0MsU0FBU08sT0FDN0JSLEtBQUtDLFNBQVNRLEtBQUtKLEdBQ2ZBLEVBQU9LLFNBQVNWLEtBQUtFLGdCQUFnQk8sS0FBS0osR0FDOUNMLEtBQUtXLGNBQ0VYLEtBR1RGLGNBQ0VFLEtBQUtFLGdCQUFnQlUsS0FBSyxDQUFDQyxFQUFHQyxJQUNyQkQsRUFBRUUsU0FBV0QsRUFBRUMsVUFBWUYsRUFBRU4sTUFBUU8sRUFBRVAsT0FJbERULFVBQVVLLEdBQ1IsT0FBT0gsS0FBS0MsU0FBU2UsS0FBS0MsR0FBS0EsYUFBYWQsR0FHOUNMLGFBQ0UsT0FBT0UsS0FBS0MsU0FHZEgsYUFBYUssR0FDWCxJQUFJZSxFQUFRbEIsS0FB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
